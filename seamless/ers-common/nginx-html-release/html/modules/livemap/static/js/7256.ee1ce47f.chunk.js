(self.webpackChunk_unified_livemap=self.webpackChunk_unified_livemap||[]).push([[7256],{7256:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>W});var l=n(1746),a=n(4315),i=n(2411),r=n.n(i),o=n(8049),c=n(3681),m=n(773),d=n(9688),u=n(9609),s=n(8463),v=n(9912),p=n(1749),E=n(2822),f=n(998),g=n(2302),y=n(2318),Z=n(1120),I=n(5117),h=n(9613),T=n(8222),S=n(3750),N=n(7394),D=n(4989),k=n(5858),x=n(8416),b=n(7428),w=n(4174),L=n(7560),B=(0,Z.Z)((function(e){return(0,I.Z)({fieldHeading:{fontWeight:"bold",textTransform:"capitalize",fontSize:14},fieldValue:{textTransform:"capitalize",fontSize:14}})}));const C=function(e){var t=e.headingProps,n=void 0===t?{xs:12,sm:2}:t,l=e.valueProps,a=void 0===l?{xs:12,sm:2}:l,r=e.title,o=e.value,c=((0,u.useTranslation)().t,B());return o?i.createElement(i.Fragment,null,i.createElement(p.Z,(0,L.Z)({item:!0},n),i.createElement(y.Z,{className:c.fieldHeading},r)),i.createElement(p.Z,(0,L.Z)({item:!0},a),i.createElement(y.Z,{className:c.fieldValue},o))):null};var O=n(974),z=n(6635),R=n.n(z),A=(0,Z.Z)((function(e){return(0,I.Z)({spacingTop:{marginTop:e.spacing(2)},rowSpacing:{marginBottom:e.spacing(.5)},heading:{fontWeight:700,color:"black",fontSize:11},content:{marginLeft:e.spacing(1),borderRadius:"4"},iconBox:{color:"#ff5722",fontSize:"30px",margin:"0 20px"},innerTitle:{fontWeight:"bold",fontSize:14,margin:10},displayBlock:{display:"block"},date:{fontSize:"10px",fontStyle:"italic",color:"#ff5722"},time:{fontSize:"10px",fontStyle:"italic",color:"green"},orderBox:{border:"1px solid #EDEDED",margin:"10px",width:"100%",borderRadius:"10px",padding:"10px",background:"#F7F7F7"},timelineRoot:{"& .MuiTimelineItem-missingOppositeContent:before":{flex:"0",padding:"0px"},"& .MuiTimelineSeparator-root":{textAlign:"center"}}})}));const F=function(e){var t,n=e.trip,l=e.loading,a=A(),r=(0,u.useTranslation)().t,o=function(e,t){return t=t||"","".concat(e=e||0," ").concat(t)},m=n&&(null==n||null===(t=n.taskList)||void 0===t?void 0:t.map((function(e){return e.lastUpdated})).map((function(e){return null==e?void 0:e.split(" ")})));return l?i.createElement(c.Z,null):i.createElement(i.Fragment,null,i.createElement(p.Z,{container:!0,spacing:3},i.createElement(p.Z,{item:!0,xs:12},i.createElement(y.Z,{variant:"h6",className:a.spacingTop},r("tripDetails")))),i.createElement(p.Z,{container:!0},i.createElement(O.Timeline,{className:a.timelineRoot},i.createElement(y.Z,{variant:"caption",className:a.heading},r("tripTimeLine")),i.createElement(p.Z,null,n&&(null==n?void 0:n.taskList)&&i.createElement("div",{className:a.displayBlock},null==n?void 0:n.taskList.map((function(e,t){var n,l,c,d,u,s,v,E,f,g,Z,I,h,T,S,N,k,x,b,w,L,B,z,A,F,q,M,W,P,U,_,V,H,K,Y;return i.createElement("div",{key:e.taskId},i.createElement(O.TimelineItem,null,i.createElement(O.TimelineSeparator,{style:{color:"#ff5722"}},i.createElement(D.Z,{className:a.iconBox}),i.createElement("div",null,"COLLECTION"===e.taskType?i.createElement(y.Z,{style:{color:"#00000061"}},null===(n=e.manualData)||void 0===n||null===(l=n.collectionInfo)||void 0===l?void 0:l.posId):"SURVEY_COLLECTION"===e.taskType?i.createElement(y.Z,{style:{color:"#00000061"}},null===(c=e.surveyData)||void 0===c||null===(d=c.posInfo[0])||void 0===d?void 0:d.resellerId):i.createElement(y.Z,{style:{color:"#00000061"}},null===(u=e.orderData)||void 0===u||null===(s=u.posInfo[0])||void 0===s?void 0:s.resellerId),i.createElement("div",{key:t},i.createElement(y.Z,{className:a.date},r("date"),": ",m?m[t][0]:""),i.createElement(y.Z,{className:a.time},r("time"),": ",m?m[t][1]:""))),i.createElement(O.TimelineConnector,{style:{height:"12px",color:"red"}})),i.createElement(O.TimelineContent,{className:(a.rowSpacing,a.orderBox)},e&&e.orderData&&(null===(v=e.orderData)||void 0===v?void 0:v.deliveryOrder)&&i.createElement(p.Z,{item:!0,xs:12,className:a.spacingTop},i.createElement(y.Z,{color:"primary",variant:"subtitle2",className:a.innerTitle},r("posId"),": ",null===(E=e.orderData)||void 0===E||null===(f=E.posInfo[0])||void 0===f?void 0:f.resellerId)),e&&e.surveyData&&(null===(g=e.surveyData)||void 0===g?void 0:g.posInfo)&&i.createElement(p.Z,{item:!0,xs:12,className:a.spacingTop},i.createElement(y.Z,{color:"primary",variant:"subtitle2",className:a.innerTitle},r("posId"),": ",(null===(Z=e.surveyData)||void 0===Z||null===(I=Z.posInfo[0])||void 0===I?void 0:I.resellerId).toUpperCase())),e&&e.manualData&&(null===(h=e.manualData)||void 0===h?void 0:h.collectionInfo)&&i.createElement(p.Z,{item:!0,xs:12,className:a.spacingTop},i.createElement(y.Z,{color:"primary",variant:"subtitle2",className:a.innerTitle},r("posId"),": ",null===(T=e.manualData)||void 0===T||null===(S=T.collectionInfo)||void 0===S?void 0:S.posId)),i.createElement(p.Z,{container:!0,spacing:3,className:(a.rowSpacing,a.orderBox)},i.createElement(C,{title:r("type"),value:null==e?void 0:e.taskType}),(null===(N=e.orderData)||void 0===N||null===(k=N.deliveryOrder)||void 0===k?void 0:k.orderRows)&&(null===(x=e.orderData)||void 0===x||null===(b=x.deliveryOrder)||void 0===b?void 0:b.orderRows.length)>0&&i.createElement(i.Fragment,null,null===(w=e.orderData)||void 0===w||null===(L=w.deliveryOrder)||void 0===L||null===(B=L.orderRows)||void 0===B?void 0:B.map((function(e,t){var n,l,a,c,m,d,u,s,v,p,E;return i.createElement(i.Fragment,{key:t},e.product&&i.createElement(i.Fragment,null,i.createElement(C,{title:r("productCode"),value:null===(n=e.product)||void 0===n?void 0:n.productCode}),i.createElement(C,{title:r("productId"),value:null===(l=e.product)||void 0===l?void 0:l.productId}),i.createElement(C,{title:r("productName"),value:null===(a=e.product)||void 0===a?void 0:a.productName}),i.createElement(C,{title:r("productSKU"),value:null===(c=e.product)||void 0===c?void 0:c.productSKU}),i.createElement(C,{title:r("productType"),value:null===(m=e.product)||void 0===m?void 0:m.productType}),i.createElement(C,{title:r("weight"),value:o(null===(d=e.product)||void 0===d||null===(u=d.weight)||void 0===u?void 0:u.value,null===(s=e.product)||void 0===s||null===(v=s.weight)||void 0===v?void 0:v.unit)}),e.quantity&&i.createElement(C,{title:r("quantity"),value:o(null===(p=e.quantity)||void 0===p?void 0:p.quantity,null===(E=e.quantity)||void 0===E?void 0:E.unit)})))}))),(null===(z=e.surveyData)||void 0===z?void 0:z.surveyInfo)&&!R().isEmpty(null===(A=e.surveyData)||void 0===A?void 0:A.surveyInfo)&&i.createElement(i.Fragment,null,i.createElement(C,{title:r("isSurveyMandatory"),value:null!==(F=e.surveyData)&&void 0!==F&&null!==(q=F.surveyInfo)&&void 0!==q&&q.isSurveyMandatory?"YES":"NO"}),i.createElement(C,{title:r("name"),value:null===(M=e.surveyData)||void 0===M||null===(W=M.surveyInfo)||void 0===W?void 0:W.name}),i.createElement(C,{title:r("title"),value:null===(P=e.surveyData)||void 0===P||null===(U=P.surveyInfo)||void 0===U?void 0:U.title})),(null===(_=e.manualData)||void 0===_?void 0:_.collectionInfo)&&!R().isEmpty(null===(V=e.manualData)||void 0===V?void 0:V.collectionInfo)&&i.createElement(i.Fragment,null,i.createElement(C,{title:r("dueAmount"),value:null===(H=e.manualData)||void 0===H||null===(K=H.collectionInfo)||void 0===K?void 0:K.dueAmount}),i.createElement(C,{title:r("dueDate"),value:null===(Y=e.manualData)||void 0===Y?void 0:Y.collectionInfo.dueDate}))))))}))),"ENDED"===(null==n?void 0:n.tripStatus)&&i.createElement("div",{className:a.displayBlock},i.createElement(O.TimelineItem,{style:{marginLeft:10}},i.createElement(O.TimelineSeparator,null,i.createElement(O.TimelineDot,{className:a.iconBox})),i.createElement(O.TimelineContent,{className:(a.rowSpacing,a.orderBox),style:{marginLeft:18}},r("tripEnd"))))))))};var q=n(3664),M=(0,Z.Z)((function(e){return(0,I.Z)({tripSummary:{backgroundColor:"#f7f7f7e6"},tripId:{padding:e.spacing(1),marginBottom:5},infoBlock:{padding:e.spacing(1)},infoTitle:{fontSize:14,fontWeight:"bold"},deliverItemSummary:{width:"100%",marginTop:10,"& tr":{textAlign:"center"}},table:{fontSize:16,"& th":{fontSize:14,fontWeight:"bold"}},deliverItemsTitle:{fontSize:16,fontWeight:"bold"},total:{"& td":{fontSize:14,fontWeight:"bold"}},deliverItemsContent:{height:210,"& tr":{verticalAlign:"baseline"}}})}));const W=function(){var e,t,n,Z,I=(0,o.useRouteMatch)().params,L=r().useState(),B=(0,a.Z)(L,2),C=B[0],O=B[1],z=(0,i.useState)(!1),R=(0,a.Z)(z,2),A=R[0],W=R[1],P=(0,i.useState)(!1),U=(0,a.Z)(P,2),_=U[0],V=U[1],H=(0,i.useState)([]),K=(0,a.Z)(H,2),Y=K[0],j=K[1],G=(0,i.useState)(null),Q=(0,a.Z)(G,2),J=Q[0],X=Q[1],$=(0,u.useTranslation)().t,ee=(0,q.Z)().showErrorMessage,te=M();(0,i.useEffect)((function(){I.tripId&&(W(!0),(0,w.Ig)(I.tripId).then((function(e){X(e);var t=e.posList.map((function(e){return e.posId})),n=e.warehouseList.map((function(e){return e.warehouseId})),a=e.collectorList.map((function(e){return e.collectorId}));return[].concat((0,l.Z)(t),(0,l.Z)(n),(0,l.Z)(a))})).then((function(e){return(0,b.Ou)(e)})).then((function(e){j(e.markers)})).catch((function(e){W(!1),V(!0)})).finally((function(){return W(!1)})))}),[I.tripId]),(0,i.useEffect)((function(){var e;if(null!=J&&null!==(e=J.agentInfo)&&void 0!==e&&e.agentId){var t,n={dealerID:{id:null==J||null===(t=J.agentInfo)||void 0===t?void 0:t.agentId,type:"RESELLERID"},fetchAccountBalanceInformation:!0};(0,w.Gg)(n).then((function(e){O(e.resellerInfo)})).catch((function(e){return ee(e)}))}}),[null==J||null===(e=J.agentInfo)||void 0===e?void 0:e.agentId]);var ne=C&&(null==C?void 0:C.additionalFields.find((function(e){return"region"===e.name})));function le(){return J&&0!==J.warehouseList.length?J.warehouseList.map((function(e){return e.data.deliveryOrderData.itemSummaryList})).flat():[]}function ae(){var e={total:0,quantity:0},t=le();return t&&t.length>0&&(e.quantity=t.reduce((function(e,t){return e+t.quantity}),0),e.total=t.reduce((function(e,t){return e+(t.netAmount||0)}),0)),e}return A?r().createElement(c.Z,null):_?r().createElement(r().Fragment,null,r().createElement(d.Z,{severity:"error"},"Error loading trip details"),r().createElement(m.SeamlessButton,{style:{marginTop:20},component:o.Link,to:"/home/livemap",variant:"contained",color:"primary"},$("back","Back"))):r().createElement(m.SeamlessContainer,{title:$("viewTripInfo","Trip Info"),description:$("viewTripInfoDescription","")},r().createElement(y.Z,{variant:"body1",className:te.tripId},"".concat($("tripId","Trip ID")," : ").concat(I.tripId)),r().createElement(s.Z,{elevation:0,className:te.tripSummary},r().createElement(v.Z,null,r().createElement(p.Z,{container:!0,justifyContent:"space-between"},r().createElement(p.Z,{item:!0,style:{borderRight:"1px solid gray",flex:1,paddingRight:10}},r().createElement(p.Z,{container:!0},r().createElement(p.Z,{item:!0,style:{marginRight:20,padding:10}},r().createElement(x.Z,{height:360,width:450,markers:Y})),r().createElement(p.Z,{item:!0,style:{padding:10,display:"flex"}},r().createElement("div",{style:{width:230}},r().createElement("section",{className:te.infoBlock},r().createElement(y.Z,{variant:"h6",className:te.infoTitle},$("region","Region")),r().createElement(y.Z,{variant:"body2"},ne?ne.value:"")),r().createElement("section",{className:te.infoBlock},r().createElement(y.Z,{variant:"h6",className:te.infoTitle},$("POS","POS")),r().createElement(E.Z,{dense:!0},J&&Array.isArray(J.posList)&&J.posList.map((function(e,t){var n;return r().createElement(f.Z,{key:t},r().createElement(D.Z,{style:{fontSize:15}}),r().createElement(y.Z,{variant:"caption",style:{margin:5}},null==e||null===(n=e.posInfo)||void 0===n?void 0:n.resellerName),r().createElement(k.Z,{style:{fontSize:15,color:"COMPLETED"===e.status?"green":"red"}}))}))))),r().createElement("div",{style:{width:230}},r().createElement("section",{className:te.infoBlock},r().createElement(y.Z,{variant:"h6",className:te.infoTitle},$("createdOn","createdOn")),r().createElement(y.Z,{variant:"body1"},null==J?void 0:J.createdOnDate.split(" ")[0])),r().createElement("section",{className:te.infoBlock},r().createElement(y.Z,{variant:"h6",className:te.infoTitle},$("agent","Agent")),r().createElement(y.Z,{variant:"body1"},null==J||null===(t=J.agentInfo)||void 0===t?void 0:t.agentName)))))),r().createElement(p.Z,{item:!0,style:{padding:10,width:"25%"}},r().createElement("section",{style:{textAlign:"center"}},r().createElement(y.Z,{variant:"h5",className:te.deliverItemsTitle},$("deliveryItemSummary","Delivery Item Summary"))),r().createElement(g.Z,{className:te.table},r().createElement(S.Z,null,r().createElement(N.Z,null,r().createElement(T.Z,{align:"center"},"Product Title"),r().createElement(T.Z,{align:"center"},"Quantity"),r().createElement(T.Z,{align:"center"},"Amount"))),r().createElement(h.Z,{className:te.deliverItemsContent},le().map((function(e,t){return r().createElement(N.Z,{key:t},r().createElement(T.Z,{align:"center"},e.name),r().createElement(T.Z,{align:"center"},e.quantity),r().createElement(T.Z,{align:"center"},e.netAmount||0))})))),r().createElement(g.Z,null,r().createElement(h.Z,null,r().createElement(N.Z,{className:te.total},r().createElement(T.Z,null,$("total","Total")),r().createElement(T.Z,{align:"center"},null===(n=ae())||void 0===n?void 0:n.quantity),r().createElement(T.Z,{align:"center"},null===(Z=ae())||void 0===Z?void 0:Z.total)))))))),r().createElement(F,{trip:J,loading:A}),r().createElement(m.SeamlessButton,{style:{marginTop:20},component:o.Link,to:"/home/livemap",variant:"contained",color:"primary"},$("back","Back")))}}}]);