(self.webpackChunk_unified_order=self.webpackChunk_unified_order||[]).push([[2407],{42407:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var l=r(74315),n=r(2411),a=r.n(n),s=r(12783),o=r(6277),i=r(21602),u=r(33553),c=r(23664),d=r(75696),f=r(48049),m=r(91787),p=r(13029),v=r(13268),b=r(67757),h=r(86149),g=r(82037),S=r(51119),y=r(41744),I=r.n(y),D=r(19985),E=r(21324);function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,l)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){(0,S.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var C=window.config.resellerAdditionalConfig.BasicResellerInfoAPILimit||100;const Z=function(e){e.state;var t=e.loadData,r=e.onSelect,s=e.selectedItems,o=void 0===s?[]:s,i=(e.search,e.searchedData,(0,n.useState)(!1)),u=(0,l.Z)(i,2),c=u[0],d=u[1],f=(0,n.useState)(C),m=(0,l.Z)(f,2),p=m[0],v=(m[1],(0,n.useState)(1)),b=(0,l.Z)(v,2),h=b[0],g=b[1],y=(0,n.useState)("asc"),w=(0,l.Z)(y,2),Z=w[0],M=w[1],k=(0,n.useState)("resellerId"),P=(0,l.Z)(k,2),O=P[0],j=P[1],x=(0,n.useState)({}),R=(0,l.Z)(x,2),F=R[0],A=R[1],B=(0,n.useState)([]),_=(0,l.Z)(B,2),q=_[0],H=_[1],L=(0,n.useState)(0),G=(0,l.Z)(L,2),T=G[0],z=G[1],U=(0,n.useCallback)((function(){d(!0),t({order:Z,page:h,perPage:p,orderBy:O,filter:(0,D.Er)(F)}).then((function(e){H(e.resellers),z(e.totalCount)})).finally((function(){return d(!1)}))}),[Z,h,p,O,F]);(0,n.useEffect)((function(){U()}),[U]);var J=[{field:"checkbox",renderHeader:function(){return a().createElement(E.Z,{onClick:function(){},disabled:!0,indeterminate:o.length>0})},width:80,hideSortIcons:!0,disableColumnMenu:!0,renderCell:function(e){return a().createElement(E.Z,{onChange:function(){return r(e.row.resellerData)},checked:o.includes(e.row.id)})}},{field:"resellerId",headerName:"Reseller ID",flex:1,filterable:!0,sortable:!0,valueGetter:function(e){return e.row.resellerData.resellerId}},{field:"name",headerName:"Reseller Name",flex:1,filterable:!0,sortable:!0,valueGetter:function(e){return e.row.resellerData.resellerName}},{field:"resellerPath",headerName:"Reseller Path",flex:1,filterable:!0,sortable:!0,valueGetter:function(e){return e.row.resellerData.resellerPath}},{field:"resellerMSISDN",headerName:"Reseller MSISDN",flex:1,filterable:!0,sortable:!0,valueGetter:function(e){return e.row.resellerData.resellerMSISDN}}],K=(0,n.useCallback)((function(e){var t=e.filterModel.items[0].value,r=e.filterModel.items[0].columnField;A(N(N({},F),{},(0,S.Z)({},r,t)))}),[]),Q=(0,n.useCallback)((function(e){var t=e.sortModel[0].field,r=e.sortModel[0].sort;j(t),M(r)}),[]);return a().createElement("div",{style:{height:400}},a().createElement(I(),{loading:c,rows:q,columns:J,getRowId:function(e){return e.resellerData.resellerId},disableColumnSelector:!0,disableDensitySelector:!0,disableSelectionOnClick:!0,pagination:!0,rowCount:T,page:h-1,onPageChange:function(e){g(e.page+1)},filterMode:"server",onFilterModelChange:K,onSortModelChange:Q,sortingMode:"server"}))};var M=r(12611),k=r(94554),P=r(76635),O=r(61990),j=r(24235),x=r(63135),R=function(e){var t,r=e.state,l=e.dispatch,n=(0,i.Z)();return a().createElement(Z,{dispatch:l,state:r,loadData:function(e){var t={additionalFields:[{name:"snic_category",value:"Agent"}],resellerData:{parentResellerId:n.requestedPrincipalId,status:"Active"}};return(0,g.ml)(t,e)},selectedItems:null!=r&&null!==(t=r.buyer)&&void 0!==t&&t.resellerId?[r.buyer.resellerId]:[],onSelect:function(e){l({type:"buyer_select",payload:e})}})},F=function(e){var t=e.state,r=e.dispatch;return a().createElement(h.default,{state:t,dispatch:r})},A=function(e){var t,r=e.dispatch,l=e.state;return a().createElement(O.Z,{resellerId:(null==l||null===(t=l.seller)||void 0===t?void 0:t.resellerId)||null,state:l,dispatch:r})},B=(0,d.makeStyles)((function(e){return(0,d.createStyles)({element:{margin:e.spacing(1)},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}})}));const _=function(e){var t=e.state,r=e.dispatch,d=(0,n.useState)([]),h=(0,l.Z)(d,2),g=h[0],S=h[1],y=(0,i.Z)(),I=(0,c.Z)(),D=I.showSuccessMessage,E=I.showErrorMessage,w=B(),N=(0,n.useState)(!1),C=(0,l.Z)(N,2),Z=C[0],O=C[1],_=(0,n.useState)(),q=(0,l.Z)(_,2),H=q[0],L=q[1],G=(0,n.useState)(!1),T=(0,l.Z)(G,2),z=T[0],U=T[1],J=(0,f.useHistory)(),K=(0,x.useTranslation)().t;(0,n.useEffect)((function(){r({type:"seller_select",payload:{resellerId:null==y?void 0:y.requestedPrincipalId,resellerMSISDN:null==y?void 0:y.targetMSISDN,resellerName:null==y?void 0:y.targetPrincipalName}})}),[y]);var Q=[{label:K("pickUpLocation")},{label:K("selectStock")},{label:K("selectReceiver")},{label:K("routes")},{label:K("orderDetails")}];function V(e){var t=e.map((function(e){return(0,k.g8)(e).then((function(e){return e.group.members}))}));return Promise.all(t)}function W(){return O(!0),U(!0),V(t.groups).then((function(e){var r=Array.from((0,P.uniqBy)(e.flat(),"userId")).filter((function(e){return"member"===e.memberType})).map((function(e){return{id:e.userId,additionalFields:[]}}));return S(r),Promise.resolve((0,b.requestHelper)(t,r))})).then((function(e){return(0,p.ry)(e)})).then((function(e){0===e.resultCode?(D(e),L({message:e.resultMessage,kind:"success"}),U(!1)):(O(!1),E(e))})).catch((function(e){O(!1),E(e)}))}function X(e){var r;switch(e){case 0:return 0===t.pickupLocation.length;case 1:return!(0,j.z3)(t);case 2:return!(null!==(r=t.buyer)&&void 0!==r&&r.resellerId);case 3:return 0===t.groups.length;default:return!1}}(0,n.useEffect)((function(){V(t.groups).then((function(e){var t=Array.from((0,P.uniqBy)(e.flat(),"userId")).filter((function(e){return"member"===e.memberType})).map((function(e){return{id:e.userId,additionalFields:[]}}));S(t)}))}),[t.groups]);var Y,$,ee={Control:function(e){e.goFirst;var t=e.goNext,r=e.goPrev,l=e.disableFirst,n=e.disableLast,i=e.view;return function(e,t,r,l,n,i,c,d){var f=(0,x.useTranslation)().t;return a().createElement(u.Z,null,a().createElement(s.SeamlessButton,{onClick:e,disabled:t,className:(0,o.default)(r.element),color:"primary",variant:"contained"},f("previous")),a().createElement(s.SeamlessButton,{className:(0,o.default)(r.element),onClick:l,disabled:n||i(c),color:"primary",variant:"contained"},f("next")),n&&a().createElement(s.SeamlessButton,{className:(0,o.default)(r.element),onClick:d,color:"primary",variant:"contained"},f("submit")))}(r,l,w,t,n,X,i,W)}},te=(0,b.requestHelper)(t,g);return a().createElement(a().Fragment,null,Z&&a().createElement(m.Z,{loading:z,orderMessage:H,handleClose:function(){O(!1),r({type:"reset",payload:null}),J.push("/home/order/orders")}}),a().createElement(s.SeamlessStepper,{steps:Q,components:ee},a().createElement(F,{dispatch:r,state:t}),a().createElement(A,{dispatch:r,state:t}),a().createElement(R,{state:t,dispatch:r}),a().createElement(M.default,{dispatch:r,state:t}),a().createElement(v.Z,{dataAPI:te,state:t,from:($=null==t?void 0:t.seller,{resellerId:null==$?void 0:$.resellerId,resellerMSISDN:null==$?void 0:$.resellerMSISDN,resellerName:null==$?void 0:$.resellerName}),to:(Y=null==t?void 0:t.buyer,{resellerId:null==Y?void 0:Y.resellerId,resellerMSISDN:null==Y?void 0:Y.resellerMSISDN,resellerName:null==Y?void 0:Y.resellerName}),itemList:(0,j.RH)(t),dispatch:r})))}}}]);