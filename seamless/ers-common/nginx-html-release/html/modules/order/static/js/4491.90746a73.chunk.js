(self.webpackChunk_unified_order=self.webpackChunk_unified_order||[]).push([[4491],{24491:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>B});var l=t(74315),n=t(2411),a=t.n(n),s=t(12783),i=t(6277),o=t(21602),u=t(13268),c=t(33553),d=t(75696),m=t(23664),p=t(8629),f=t(49429),v=t(38724),S=t(79249),y=t(12231),I=t(73698),g=t(86619),h=t(13029),b=t(99491),E=t(28120),N=t(48049),Z=t(63135),C=t(82037),T=t(74208),k=(0,d.makeStyles)((function(e){return(0,d.createStyles)({element:{margin:e.spacing(1)}})}));const B=function(e){var r,t,d=e.state,B=e.dispatch,M=k(),w=(0,o.Z)(),P=(0,n.useState)(!1),A=(0,l.Z)(P,2),D=A[0],R=A[1],q=(0,n.useState)([]),_=(0,l.Z)(q,2),H=_[0],O=_[1],x=(0,n.useState)(),F=(0,l.Z)(x,2),L=F[0],W=F[1],j=(0,n.useState)(),G=(0,l.Z)(j,2),U=G[0],K=G[1],z=((0,Z.useTranslation)().t,(0,m.Z)()),J=z.showErrorMessage,Q=z.showSuccessMessage,V=z.showInfoMessage,X=(0,N.useHistory)();function Y(){R(!1),W(null),K("")}function $(e){switch(e){case 0:return null===d.returnTo;case 1:return null===d.returnOrder;default:return!1}}(0,n.useEffect)((function(){B({type:"buyer_select",payload:{resellerId:null==w?void 0:w.requestedPrincipalId,resellerMSISDN:null==w?void 0:w.targetMSISDN,resellerName:null==w?void 0:w.targetPrincipalName}})}),[w]),(0,n.useEffect)((function(){B({type:"buyer_select",payload:{resellerId:null==w?void 0:w.requestedPrincipalId,resellerMSISDN:null==w?void 0:w.targetMSISDN,resellerName:null==w?void 0:w.targetPrincipalName}})}),[w]),(0,n.useEffect)((function(){(0,h.an)().then((function(e){O(e.orderReasons)})).catch((function(e){console.error(e),V("Unable to load return reason list")}))}),[]);var ee,re,te=(0,b.requestHelper)(d,U);return a().createElement(a().Fragment,null,a().createElement(p.Z,{open:D,onClose:Y,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0,maxWidth:"sm",disableBackdropClick:!0},a().createElement(S.Z,{id:"alert-dialog-title"},"Please specifiy the reason of return"),a().createElement(v.Z,null,a().createElement(I.Z,{style:{marginTop:20},labelId:"demo-simple-select-label",id:"demo-simple-select",value:L,onChange:function(e){K("");var r=e.target.value;W(r);var t=H.find((function(e){return e.code===r}));K(t.description)},fullWidth:!0},H.map((function(e){return a().createElement(y.Z,{key:e.code,value:e.code},e.code)}))),"OTHER"===L&&a().createElement(g.Z,{fullWidth:!0,multiline:!0,rowsMax:5,rows:5,value:U,style:{marginTop:30},placeholder:"Specify other reasons",onChange:function(e){e.target.value.length>=400||K(e.target.value)}})),a().createElement(f.Z,null,a().createElement(s.SeamlessButton,{onClick:Y,color:"primary"},"Cancel"),a().createElement(s.SeamlessButton,{disabled:!U,onClick:function(){var e=(0,b.requestHelper)(d,U);(0,h.ry)(e).then((function(e){0===e.resultCode?(Y(),Q(e),setTimeout((function(){B({type:"reset",payload:null}),X.push("/home/order/orders")}),500)):(Y(),J(e))})).catch((function(e){Y(),J(e)}))},color:"primary",variant:"contained",autoFocus:!0},"Return"))),a().createElement(s.SeamlessStepper,{steps:[{label:"Return to"},{label:"Inventory"},{label:"Review & Submit"}],components:{Control:function(e){e.goFirst;var r=e.goNext,t=e.goPrev,l=e.disableFirst,n=e.disableLast,o=e.view;return a().createElement(c.Z,null,a().createElement(s.SeamlessButton,{onClick:t,disabled:l,className:(0,i.default)(M.element),color:"primary",variant:"contained"},"Previous"),a().createElement(s.SeamlessButton,{className:(0,i.default)(M.element),onClick:r,disabled:n||$(o),color:"primary",variant:"contained"},"Next"),n&&a().createElement(s.SeamlessButton,{className:(0,i.default)(M.element),onClick:function(){R(!0)},color:"primary",variant:"contained"},"Submit"))}}},a().createElement(T.Z,{dispatch:B,state:d,loadData:function(e){return(0,C.yS)(w.requestedPrincipalId.toString(),e)},selectedItems:null!=d&&null!==(r=d.buyer)&&void 0!==r&&r.resellerId?[d.buyer.resellerId]:[],onSelect:function(e){B({type:"return_to_select",payload:e})},hidden:!0}),a().createElement(E.Z,{state:d,dispatch:B,buyerId:w.requestedPrincipalId,selectedItem:null==d||null===(t=d.returnOrder)||void 0===t?void 0:t.orderId}),a().createElement(u.Z,{dataAPI:te,state:d,from:(re=null==d?void 0:d.buyer,{resellerId:null==re?void 0:re.resellerId,resellerMSISDN:null==re?void 0:re.resellerMSISDN,resellerName:null==re?void 0:re.resellerName}),to:function(){var e=null==d?void 0:d.returnTo;return{resellerId:null==e?void 0:e.resellerId,resellerMSISDN:null==e?void 0:e.resellerMSISDN,resellerName:null==e?void 0:e.resellerName}}(),itemList:(ee=function(e){return e.batchIds&&Array.isArray(e.batchIds)&&"BATCH"===e.reserveType?e.batchIds.join(", "):"SERIAL"===e.reserveType?"-":"RANGE"===e.reserveType?e.ranges.map((function(e){return e.batchId})).join(", "):"-"},d.returnOrder&&d.returnOrder.orderId?d.returnOrder.items.map((function(e){return{productSKU:e.productSku,quantity:parseInt((r=e,"RANGE"===r.reserveType?r.ranges.reduce((function(e,r){return BigInt(r.endSerial)-BigInt(r.startSerial)+BigInt(e)}),0)+BigInt(1):"SERIAL"===r.reserveType?r.serials.length:"BATCH"===r.reserveType?r.quantity:0).toString(),10),boxId:ee(e)};var r})):[]),dispatch:B})))}}}]);