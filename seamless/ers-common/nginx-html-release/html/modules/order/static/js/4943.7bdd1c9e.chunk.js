(self.webpackChunk_unified_order=self.webpackChunk_unified_order||[]).push([[4943],{79650:(e,t,n)=>{"use strict";function l(e){var t,n=e&&e.selectedStock.length+e.selectedByRange.length,l=0;Object.keys(null==e?void 0:e.serials).map((function(t){var n,r,a=Object.values(null==e?void 0:e.serials[t]);a&&(null===(n=a[0])||void 0===n?void 0:n.length)>=1&&(l+=null===(r=Object.values(null==e?void 0:e.serials[t]))||void 0===r?void 0:r.length)}));var r=e.services.topups.length,a=null==e||null===(t=e.stockQuantity)||void 0===t?void 0:t.length;return n+l+r+a}function r(e){return l(e)>0||!1}n.d(t,{e:()=>l,z:()=>r})},27115:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ge});var l=n(11746),r=n(56470),a=n(51119),i=n(74315),o=n(77162),u=n.n(o),c=n(2411),d=n.n(c),s=n(63135),m=n(41744),v=n.n(m),p=n(67358),f=n(77277),y=n(80030),g=n(38592),S=n(26739),b=n(61837),E=n(90436),h=n(21324),Z=n(23664),w=n(19653),I=n(2366),R=n(75696),x=n(33882),k=n(29226),O=n(13029),N=n(21602),T=n(8629),C=n(49429),P=n(38724),j=n(79249),q=n(37390),B=n(97485),L=n(15584),U=n(91256),K=n(58987),A=n(89571),_=n(9495),D=n(76635),M=(0,R.makeStyles)((function(e){var t,n;return{dialogContent:{backgroundColor:e.palette.primary.main,color:null==e||null===(t=e.palette)||void 0===t||null===(n=t.common)||void 0===n?void 0:n.white}}}));const F=function(e){var t=e.state,n=(e.dispatch,e.onClose),r=e.removeItem,a=M(),o=(0,s.useTranslation)().t,u=(0,c.useState)(0),m=(0,i.Z)(u,2),v=m[0],p=m[1];function y(){var e=t.selectedByRange.map((function(e){var t,n;return{itemRow:e.itemRow,productSKU:e.productSKU,quantity:e.quantity,quantSelected:e.quantity,boxId:e.boxId,startSerial:e.startSerial,endSerial:e.endSerial,reserverType:"RANGE",amount:null==e||null===(t=e.itemRow)||void 0===t||null===(n=t.unitPrice)||void 0===n?void 0:n.amount}})),n=t.stockRows.map((function(e){return{productSKU:e.productSKU,quantity:e.quantity,boxId:e.boxId,reserverType:"BATCH",startSerial:e.startSerial,endSerial:e.endSerial}})),r=function(){var e=t.serials,n=t.price;try{return Object.keys(e).map((function(t){return Object.keys(e[t]).map((function(l){return{productSKU:t,boxId:l,quantity:e[t][l].length,reserverType:"SERIAL",amount:n[t][0]}}))})).flat()}catch(e){return[]}}(),a=function(){var e=t.services.topups,n=(0,D.groupBy)(e,"productSKU");return Object.keys(n).map((function(e){return{productSKU:e,quantity:n[e].length,boxId:"-",reserverType:"TOPUP"}}))}(),i=t.stockQuantity.map((function(e){var t,n,l,r;return{productSKU:e.productSKU,quantity:e.quantity,boxId:"-",reserverType:"NON_SERIAL",amount:null!=e&&null!==(t=e.unitPrice)&&void 0!==t&&t.price?null==e||null===(n=e.unitPrice)||void 0===n?void 0:n.price:null==e||null===(l=e.itemRow)||void 0===l||null===(r=l.unitPrice)||void 0===r?void 0:r.amount}}));return[].concat((0,l.Z)(e),(0,l.Z)(n),(0,l.Z)(r),(0,l.Z)(a),(0,l.Z)(i))}return(0,c.useEffect)((function(){var e,t=0;null===(e=y())||void 0===e||e.forEach((function(e){t+=parseInt(null==e?void 0:e.quantity)*(null!=e&&e.amount?parseInt(null==e?void 0:e.amount):0)})),p(t)}),[t]),d().createElement(T.Z,{open:!0,maxWidth:"lg",fullWidth:!0,disableBackdropClick:!0,disableEscapeKeyDown:!0,disablePortal:!0},d().createElement(j.Z,{className:a.dialogContent,id:"alert-dialog-title"},o("selectedItems")),d().createElement(P.Z,null,d().createElement(U.Z,null,d().createElement(q.Z,{"aria-label":"a dense table"},d().createElement(K.Z,null,d().createElement(A.Z,null,d().createElement(L.Z,null,o("productSku")),d().createElement(L.Z,null,o("reserveType")),d().createElement(L.Z,null,o("batchId")),d().createElement(L.Z,null,o("quantity")),d().createElement(L.Z,null,o("price")),d().createElement(L.Z,null,o("total")))),d().createElement(B.Z,null,y().map((function(e,t){return e.quantity>0&&d().createElement(A.Z,{key:t},d().createElement(L.Z,{component:"th",scope:"row"},e.productSKU),d().createElement(L.Z,null,e.reserverType),d().createElement(L.Z,null,e.boxId),d().createElement(L.Z,null,e.quantity),d().createElement(L.Z,null,e.amount),d().createElement(L.Z,null,null!=e&&e.amount?(null==e?void 0:e.quantity)*(null==e?void 0:e.amount):null),d().createElement(L.Z,null,d().createElement(b.Z,{size:"small",disableRipple:!0,onClick:function(){return r(e)}},d().createElement(_.Z,{fontSize:"small"}))))})),"0"!=v&&v&&d().createElement(A.Z,{key:v},d().createElement(L.Z,null),d().createElement(L.Z,null),d().createElement(L.Z,null),d().createElement(L.Z,null),d().createElement(L.Z,null,o("cartTotal")),d().createElement(L.Z,null,v)))))),d().createElement(C.Z,null,d().createElement(f.Z,{onClick:n,color:"primary"},o("closeButton"))))},W=function(e){var t=e.state,n=e.dispatch,l=e.inventoryList,r=e.boxId,a=e.productSKU,o=e.handleClose,u=(0,c.useState)(!1),m=(0,i.Z)(u,2),p=m[0],y=m[1],g=(0,c.useState)([]),S=(0,i.Z)(g,2),b=S[0],E=S[1],h=(0,c.useState)(1),Z=(0,i.Z)(h,2),w=Z[0],I=Z[1],R=(0,s.useTranslation)().t,x=(0,c.useCallback)((function(){if(y(!0),(null==l?void 0:l.length)>0){var e=null==l?void 0:l.map((function(e){return e.id=e.serialNo,e}));e&&E(e)}y(!1)}),[]);function k(){try{return t.serials[a][r]}catch(e){return[]}}(0,c.useEffect)((function(){x()}),[]);var O=[{field:"serialNo",flex:1,headerName:R("serial"),filterable:!0,sortable:!0},{field:"productSKU",flex:1,headerName:R("productSku"),filterable:!0,sortable:!0}];return d().createElement(T.Z,{open:!0,onClose:o,"aria-labelledby":"form-dialog-title",disableBackdropClick:!0,disableEscapeKeyDown:!0,fullWidth:!0,maxWidth:"md",disableEnforceFocus:!0},d().createElement(j.Z,{id:"form-dialog-title"},R("selectItems")),d().createElement(P.Z,null,d().createElement(v(),{loading:p,rows:b,columns:O,checkboxSelection:!0,disableColumnMenu:!0,disableDensitySelector:!0,disableColumnReorder:!0,disableColumnSelector:!0,page:w-1,onFilterModelChange:function(e){I(1)},onPageChange:function(e){I(e.page+1)},onPageSizeChange:function(e){I(1)},autoHeight:!0,onSelectionModelChange:function(e){var t=e.selectionModel;b.filter((function(e){return t.includes(e.serialNo)})),(0,D.isEqual)(e.selectionModel,k())||r&&a&&n({type:"box_item_selected",payload:{items:t,boxId:r,productSKU:a}})},selectionModel:k(),getRowId:function(e){return e.serialNo}})),d().createElement(C.Z,null,d().createElement(f.Z,{onClick:o,color:"primary"},R("closeButton"))))};var Q=n(85256),z=n(86619);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=(0,R.makeStyles)((function(e){var t,n;return{dialogContent:{backgroundColor:e.palette.primary.main,color:null==e||null===(t=e.palette)||void 0===t||null===(n=t.common)||void 0===n?void 0:n.white}}}));const J=function(e){var t=e.state,n=e.dispatch,r=e.selectedProduct,a=e.onClose,o=(e.removeItem,V()),u=(0,s.useTranslation)().t,m=(0,c.useState)(""),v=(0,i.Z)(m,2),p=v[0],y=v[1],g=(0,c.useState)(r),S=(0,i.Z)(g,2),b=S[0],E=(S[1],d().useState("1px solid transparent")),h=(0,i.Z)(E,2),Z=(h[0],h[1],d().useState(!1)),w=(0,i.Z)(Z,2),I=w[0],R=w[1],x=d().useState(!0),k=(0,i.Z)(x,2),O=k[0],N=k[1];return d().createElement(T.Z,{open:!0,maxWidth:"lg",fullWidth:!0,disableBackdropClick:!0,disableEscapeKeyDown:!0,disablePortal:!0},d().createElement(j.Z,{className:o.dialogContent,id:"alert-dialog-title"},u("selectedItems")),d().createElement(P.Z,null,d().createElement(U.Z,null,d().createElement(q.Z,{"aria-label":"a dense table"},d().createElement(K.Z,null,d().createElement(A.Z,null,d().createElement(L.Z,null,u("productSku")),d().createElement(L.Z,null,u("quantity")),d().createElement(L.Z,null))),d().createElement(B.Z,null,d().createElement(A.Z,null,d().createElement(L.Z,{component:"th",scope:"row"},b.productSKU),d().createElement(L.Z,null,b.quantity),d().createElement(L.Z,null,d().createElement("div",null,d().createElement("div",{style:{display:"flex",justifyContent:"center"}},d().createElement("div",null,d().createElement("div",null,d().createElement(z.Z,{onInput:function(e){e.target.value=e.target.value.replace(/[^0-9]*/g,"")},onChange:function(e){y(e.target.value),function(e){e&&b.quantity>=e?(R(!1),N(!1)):(R(!0),N(!0))}(e.target.value)},value:p||"",error:I,size:"small",style:{width:300,borderRadius:8,border:O?"":"1px solid green"},variant:"outlined",placeholder:u("quantity")})),I&&d().createElement("div",{style:{color:"red"}},"Select valid quantity")),d().createElement(Q.Z,{style:{height:34,margin:4},orientation:"vertical"}),d().createElement(f.Z,{disabled:O,style:{height:40},onClick:function(e){e.preventDefault();var r=G(G({},b),{},{quantity:parseInt(p.toString(),10)});r.reserveType="NON_SERIAL";var a=(0,l.Z)(t.stockQuantity),i=t.stockQuantity.findIndex((function(e){return e.productSKU===r.productSKU}));-1===i?a.push(r):a[i].quantity=r.quantity,n({type:"stock_quantity_select",payload:a})},variant:"outlined"},u("addToCart")))))))))),d().createElement(C.Z,null,d().createElement(f.Z,{onClick:a,color:"primary"},u("closeButton"))))};var X=n(79650),Y=n(60905),$=n(99688),ee=n(46062),te=n.n(ee),ne=n(28247);function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}te()(ne.Z,{attributes:{nonce:"c2VhbWxlc3M="},insert:"head",singleton:!1}),ne.Z.locals;var ae=(0,R.makeStyles)((function(e){var t,n;return{root:{backgroundColor:e.palette.primary.main,color:null==e||null===(t=e.palette)||void 0===t||null===(n=t.common)||void 0===n?void 0:n.white},grid:{width:271},formControl:{marginLeft:e.spacing(1)},spacingTop:{marginTop:e.spacing(1)}}}));const ie=function(e){var t,n,l,r,a,o,u,m,v=e.handleClose,p=e.handleSubmit,y=e.product,g=(e.inventoryList,e.state),S=ae(),b=re({},g.serialRangeList),E=(0,s.useTranslation)().t,h=null==y||null===(t=y.itemRow)||void 0===t||null===(n=t.ranges[0])||void 0===n?void 0:n.batchId,Z=null==y||null===(l=y.itemRow)||void 0===l||null===(r=l.ranges[0])||void 0===r?void 0:r.startSerial,w=null==y||null===(a=y.itemRow)||void 0===a||null===(o=a.ranges[0])||void 0===o?void 0:o.endSerial,I=(null==y||null===(u=y.itemRow)||void 0===u||null===(m=u.ranges[0])||void 0===m?void 0:m.quantity)||BigInt(w)-BigInt(Z)+BigInt(1),R=Object.keys(b).includes("".concat(h))&&Object.keys(b["".concat(h)]).includes("".concat(Z)),x=R?b[h][Z].startSerial:"",k=R?b[h][Z].endSerial:"",O=R?"".concat(BigInt(k)-BigInt(x)+BigInt("1")):"",N=(0,c.useState)({startSerial:x,endSerial:k,quantity:O}),q=(0,i.Z)(N,2),B=q[0],L=q[1],U=(0,c.useState)(!0),K=(0,i.Z)(U,2),A=K[0],_=K[1],D=(0,c.useState)(!1),M=(0,i.Z)(D,2),F=M[0],W=M[1],Q=(0,c.useState)(!1),H=(0,i.Z)(Q,2),G=H[0],V=H[1],J=(0,c.useState)(!1),X=(0,i.Z)(J,2),ee=X[0],te=X[1];function ne(e,t){var n=e.target.name,l=BigInt(t.startSerial),r=BigInt(Z),a=t.endSerial?BigInt(t.endSerial):BigInt("0"),i=BigInt(t.quantity),o=BigInt(I),u=BigInt("1");te("quantity"===n&&(i<0||i>o)),"startSerial"===n&&(a!==BigInt("0")&&l>a||l<r||l>BigInt(w))?W(!0):W(!1),"endSerial"===n&&(a<l||a<r||a>BigInt(w))?V(!0):V(!1),""!==t.startSerial&&""!==t.endSerial?_(l<r||l>a||l>r+o-u||a>r+o-u||a<r):_(!0)}return(0,c.useEffect)((function(){x&&k&&O&&_(!1)}),[]),d().createElement(T.Z,{open:!0,maxWidth:"sm",fullWidth:!0,onClose:v,disableBackdropClick:!1},d().createElement(j.Z,{className:S.root,id:"alert-dialog-title"},E("selectRange")),d().createElement(P.Z,null,d().createElement($.Z,{severity:"info",variant:"standard"},"".concat(E("startEndSerialBetween")," ").concat(Z," ").concat(E("and")," ").concat(w),d().createElement("br",null),"".concat(E("quantityBetween")," ").concat(I)),d().createElement(Y.Z,{container:!0,spacing:1,className:S.spacingTop},d().createElement(Y.Z,{item:!0,xs:12,sm:6},d().createElement(z.Z,{error:F,className:S.grid,variant:"outlined",label:E("startSerial"),name:"startSerial",type:"number",autoComplete:"off",onChange:function(e){ne(e,function(e){var t=BigInt(B.endSerial),n=BigInt(e.target.value),l=BigInt("1"),r=BigInt(I),a=BigInt(Z),i=t-n+l,o=i>0&&i<=r&&n>=a?"".concat(i):"0",u=re(re({},B),{},{startSerial:e.target.value,quantity:o});return L(u),u}(e))},onInput:function(e){e.target.value=e.target.value.replace(/[^0-9]*/g,"")},value:B.startSerial,helperText:F?E("invalidStartSerial"):""})),d().createElement(Y.Z,{item:!0,xs:12,sm:6},d().createElement(z.Z,{error:G,className:S.grid,variant:"outlined",label:E("endSerial"),name:"endSerial",type:"number",autoComplete:"off",onChange:function(e){ne(e,function(e){var t=""===B.startSerial?"".concat(Z):"".concat(B.startSerial),n=BigInt(B.startSerial),l=BigInt(e.target.value),r=BigInt("1"),a=l>=BigInt(Z)&&l<=BigInt(w)?l-n+r:0,i=BigInt(I),o=BigInt(w),u=a>0&&a<=i&&l<=o?"".concat(a):"0",c=re(re({},B),{},{endSerial:e.target.value,quantity:u,startSerial:t});return L(c),c}(e))},onInput:function(e){e.target.value=e.target.value.replace(/[^0-9]*/g,"")},helperText:G?E("invalidEndSerial"):"",value:B.endSerial})),d().createElement(Y.Z,{className:S.formControl},d().createElement(z.Z,{error:ee,className:S.grid,variant:"outlined",label:E("quantity"),name:"quantity",type:"number",autoComplete:"off",onChange:function(e){ne(e,function(e){var t=""===B.startSerial?"".concat(Z):"".concat(B.startSerial),n=BigInt(t),l=BigInt(e.target.value),r=BigInt("1"),a=BigInt(w),i=BigInt(Z),o=n+l-r,u=o<=a&&o>=i&&""!==e.target.value?"".concat(o):"",c={quantity:e.target.value,endSerial:u,startSerial:t};return L(c),c}(e))},onInput:function(e){e.target.value=e.target.value.replace(/[^0-9]*/g,"")},helperText:ee?E("invalidQuantity"):"",value:B.quantity})))),d().createElement(C.Z,null,d().createElement(f.Z,{onClick:function(){v(),_(!1)},autoFocus:!0},E("close")),d().createElement(f.Z,{disabled:A,onClick:function(){A||p(re(re({},B),{},{productSKU:y.productSKU}),h,Z,y)},color:"primary",autoFocus:!0},E("submit"))))};var oe=n(31168),ue=n(13737);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se="PARTIAL",me="FULL";function ve(){return d().createElement(w.GridOverlay,null,d().createElement("div",{style:{position:"absolute",top:0,width:"100%"}},d().createElement(p.Z,null)))}var pe,fe=(0,R.makeStyles)((function(e){return(0,R.createStyles)({buttonWrapper:{width:"100% !important"}})})),ye=[];const ge=function(e){var t,n,a,o,m,p=e.state,w=e.dispatch,R=e.resellerId,T=(0,c.useState)([]),C=(0,i.Z)(T,2),P=C[0],j=C[1],q=(0,c.useState)(),B=(0,i.Z)(q,2),L=B[0],U=B[1],K=(0,c.useState)(!1),A=(0,i.Z)(K,2),_=A[0],M=A[1],Q=(0,c.useState)(),z=(0,i.Z)(Q,2),H=z[0],G=z[1],V=(0,c.useState)(!1),Y=(0,i.Z)(V,2),$=Y[0],ee=Y[1],te=(0,c.useState)(!1),ne=(0,i.Z)(te,2),le=ne[0],re=ne[1],ae=(0,c.useState)(!1),ce=(0,i.Z)(ae,2),ge=ce[0],Se=ce[1],be=(0,c.useState)(!1),Ee=(0,i.Z)(be,2),he=Ee[0],Ze=Ee[1],we=(0,c.useState)([]),Ie=(0,i.Z)(we,2),Re=Ie[0],xe=Ie[1],ke=d().useState(se),Oe=(0,i.Z)(ke,2),Ne=Oe[0],Te=Oe[1],Ce=d().useState(!1),Pe=(0,i.Z)(Ce,2),je=Pe[0],qe=Pe[1],Be=d().useState(!0),Le=(0,i.Z)(Be,2),Ue=Le[0],Ke=Le[1],Ae=(0,s.useTranslation)().t,_e=(0,Z.Z)(),De=_e.showErrorMessage,Me=_e.showInfoMessage,Fe=(0,N.Z)(),We=fe(),Qe=(Fe.requestedPrincipalId!==R&&(null==R||R.toString()),null==p||null===(t=p.returnOrder)||void 0===t?void 0:t.orderId);function ze(e){e.boxId;var t,n,l=null===(t=e.itemRow)||void 0===t||null===(n=t.ranges[0])||void 0===n?void 0:n.startSerial,r=(0,D.cloneDeep)(p.serialRangeList),a=p.selectedSerials.filter((function(e){return e!==l}));Object.keys(r).map((function(e){Object.getOwnPropertyNames(r[e]).includes(l)&&delete r[e][l]}));var i=p.selectedByRange.filter((function(e){return e.startSerialSelected!==l}));w({type:"remove_range_select",payload:{value:r,data:i,serial:a}}),Me(Ae("isRemoved",{element:Ae("range")})),rt(se)}(0,c.useEffect)((function(){ye=ye||[],(0,O.C9)(Qe).then((function(e){if(0===e.resultCode)if(null!=e&&e.fullReturnApplicable&&Ke(!1),null!=e&&e.orderItemDetailList[0].itemDetailsList&&(null==e?void 0:e.orderItemDetailList[0].itemDetailsList.length)>0){var t=null==e?void 0:e.orderItemDetailList[0].itemDetailsList.map((function(e,t){var n,l,r,a,i,o,u,c,d,s;(e.id=t,null!==(n=e.itemRow)&&void 0!==n&&n.ranges&&e.itemRow.ranges.length>0)?(BigInt(null===(u=e.itemRow)||void 0===u||null===(c=u.ranges[0])||void 0===c?void 0:c.endSerial),BigInt(null===(d=e.itemRow)||void 0===d||null===(s=d.ranges[0])||void 0===s?void 0:s.startSerial),BigInt(1),e.continuesRange=!0):e.continuesRange=!1;return e.inventoryList&&e.inventoryList.length>0&&(e.boxId=null===(a=e.inventoryList[0])||void 0===a?void 0:a.batchId,e.productSKU=null===(i=e.inventoryList[0])||void 0===i?void 0:i.productSKU,e.quantity=null===(o=e.inventoryList[0])||void 0===o?void 0:o.quantity),w({type:"add_selected_product_price",payload:{productSKUName:null==e?void 0:e.productSKU,price:null==e||null===(l=e.itemRow)||void 0===l||null===(r=l.unitPrice)||void 0===r?void 0:r.amount}}),e}));j(t),w({type:"product_loaded",payload:t}),rt(Ne)}else De(Ae("noItemsFound"));else De(e.resultMessage)})).finally((function(){return M(!1)}))}),[]);var He=function(e){var t=[];-1!==p.stockQuantity.findIndex((function(t){return t.productSKU===e.productSKU}))&&(t=p.stockQuantity.filter((function(t){return t.productSKU!==e.productSKU})),w({type:"stock_quantity_select",payload:t}),Me(Ae("isRemoved",{element:Ae("nonSerial")})))};function Ge(e){var t,n,l,r;if(Ne===me)return!1;var a,i,o,u,c,d,s=p.stockQuantity&&p.stockQuantity.findIndex((function(t){return t.id===e.id}));if(null!=e&&null!==(t=e.itemRow)&&void 0!==t&&null!==(n=t.ranges[0])&&void 0!==n&&n.batchId&&ye.includes(null==e||null===(l=e.itemRow)||void 0===l||null===(r=l.ranges[0])||void 0===r?void 0:r.batchId)){if(Object.keys(p.serialRangeList).includes("".concat(null==e||null===(a=e.itemRow)||void 0===a||null===(i=a.ranges[0])||void 0===i?void 0:i.batchId)))return!!Object.keys(p.serialRangeList[null==e||null===(o=e.itemRow)||void 0===o||null===(u=o.ranges[0])||void 0===u?void 0:u.batchId]).includes("".concat(null==e||null===(c=e.itemRow)||void 0===c||null===(d=c.ranges[0])||void 0===d?void 0:d.startSerial))}else if(e&&e.productSKU&&p.serials[e.productSKU]){var m,v,f=p.serials[e.productSKU],y=null===(m=e.inventoryList)||void 0===m?void 0:m.map((function(e){return e.id||e.serialNo})),g=null===(v=Object.values(f).flat())||void 0===v?void 0:v.filter((function(t){var n,l;return null!==(n=e.itemRow.serials)&&void 0!==n&&n.length?-1!==(null===(l=e.itemRow.serials)||void 0===l?void 0:l.indexOf(t)):-1!==(null==y?void 0:y.indexOf(t))}));if(g&&null!=g&&g.length)return!0}else if(e&&e.productSKU&&-1!==s){var S,b=null==p||null===(S=p.stockQuantity)||void 0===S?void 0:S.find((function(t){var n,l;return(null==t?void 0:t.productSKU)==(null==e?void 0:e.productSKU)&&(null==t||null===(n=t.itemRow)||void 0===n?void 0:n.quantity)==(null==e||null===(l=e.itemRow)||void 0===l?void 0:l.quantity)}));if(!(0,D.isEmpty)(b))return!0}return!1}function Ve(e){return Je.apply(this,arguments)}function Je(){return(Je=(0,r.Z)(u().mark((function e(t){var n,r,a,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U(t.itemRow.productSKU),!p.selectedSerials.includes(t.itemRow.batchIds)){e.next=3;break}return e.abrupt("return");case 3:n=(0,l.Z)(p.stockRows),r=[],a=n.find((function(e){return e.boxId===t.itemRow.batchIds})),r=a?n.filter((function(e){return e.itemRow.batchIds!==t.itemRow.batchIds})):n.concat(t),i=r.map((function(e){return e.itemRow.batchIds})),a||Me(Ae("itemAdded")),w({type:"stock_select",payload:{ids:i,rows:r}});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xe(e){switch(e.reserverType){case"RANGE":ze(e);break;case"BATCH":Ve(e);break;case"SERIAL":Ye(e.boxId);break;case"NON_SERIAL":He(e);break;case"TOPUP":var t=p.services.topups.filter((function(t){return t.productSKU!==e.productSKU}));w({type:"topup_selected",payload:t})}}function Ye(e){var t=(0,D.cloneDeep)(p.serials);Object.keys(t).map((function(n){Object.getOwnPropertyNames(t[n]).includes(e)&&delete t[n][e]})),w({type:"set_serials",payload:t}),Me(Ae("isRemoved",{element:Ae("serial")})),rt(se)}function $e(e){var t,n,l,r,a,i;if("RANGE"===(null===(t=e.itemRow)||void 0===t?void 0:t.reserveType)&&(r=null==p||null===(a=p.selectedByRange)||void 0===a?void 0:a.find((function(t){return(null==t?void 0:t.boxId)==(null==e?void 0:e.boxId)&&(null==t?void 0:t.quantity)==(null==e?void 0:e.quantity)}))),"SERIAL"===(null===(n=e.itemRow)||void 0===n?void 0:n.reserveType)){var o=Object.keys(p.serials).map((function(e){return Object.keys(p.serials[e]).map((function(t){return{productSKU:e,boxId:t,quantity:p.serials[e][t].length}}))})).flat();o&&(r=null==o?void 0:o.find((function(t){var n;return(null==t?void 0:t.productSKU)==(null==e?void 0:e.productSKU)&&(null==t?void 0:t.quantity)==(null==e||null===(n=e.itemRow)||void 0===n?void 0:n.quantity)&&(null==t?void 0:t.boxId)==(null==e?void 0:e.boxId)})))}return"NON_SERIAL"==(null===(l=e.itemRow)||void 0===l?void 0:l.reserveType)&&(r=null==p||null===(i=p.stockQuantity)||void 0===i?void 0:i.find((function(t){return(null==t?void 0:t.productSKU)==(null==e?void 0:e.productSKU)&&(null==t?void 0:t.quantity)==(null==e?void 0:e.quantity)}))),!!r}function et(){return(et=(0,r.Z)(u().mark((function e(t){var n,r,a,i,o,c,d,s,m,v,f,y,g,S,b,E,h,Z,I,R,x,k,O,N;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&Object.keys(null==t?void 0:t.itemRow).length>0)){e.next=24;break}if("NON_SERIAL"!==(r=null==t||null===(n=t.itemRow)||void 0===n?void 0:n.reserveType)&&ye.push(null==t?void 0:t.boxId),"RANGE"!==r){e.next=19;break}return v=t,f=null==t||null===(a=t.itemRow)||void 0===a?void 0:a.productSku,y=null==t||null===(i=t.itemRow)||void 0===i||null===(o=i.ranges[0])||void 0===o?void 0:o.batchId,g=null==t||null===(c=t.itemRow)||void 0===c||null===(d=c.ranges[0])||void 0===d?void 0:d.startSerial,S=null==t?void 0:t.inventoryList,b=de({},p.serialRangeList),E=Object.keys(b),h={startSerial:g,endSerial:null==t||null===(s=t.itemRow)||void 0===s||null===(m=s.ranges[0])||void 0===m?void 0:m.endSerial,quantity:(null==S?void 0:S.length)||"",boxId:y,productSKU:f},p.selectedByRange=p.selectedByRange.filter((function(e){return e.startSerialSelected!==g})),p.selectedSerials=p.selectedSerials.filter((function(e){return e!==g})),Z=de(de({},v),{},{startSerialSelected:"".concat(h.startSerial),endSerialSelected:"".concat(h.endSerial),productSKU:f,quantity:"".concat(BigInt(h.endSerial)-BigInt(h.startSerial)+BigInt("1"))}),E.includes("".concat(y))||(b[y]={}),b[y][g]=h,p.serialRangeList=b,e.next=19,w({type:"stock_range_select",payload:{value:b,data:Z,serial:g}});case 19:if("SERIAL"!=r&&"BATCH"!=r){e.next=23;break}if(!(0,D.isEqual)(null===(I=t.itemRow)||void 0===I?void 0:I.serials,tt())){e.next=22;break}return e.abrupt("return");case 22:(null==t?void 0:t.inventoryList.length)>0&&w({type:"box_item_selected",payload:{items:null==t?void 0:t.inventoryList.map((function(e){return e.serialNo})),boxId:null==t?void 0:t.boxId,productSKU:null==t?void 0:t.productSKU}});case 23:"NON_SERIAL"==r&&((k=de(de({},t),{},{quantity:parseInt(null==t||null===(R=t.itemRow)||void 0===R||null===(x=R.quantity)||void 0===x?void 0:x.toString(),10)})).reserveType="NON_SERIAL",O=(0,l.Z)(p.stockQuantity),-1===(N=p.stockQuantity.findIndex((function(e){return e.productSKU===k.productSKU})))?O.push(k):O[N].quantity=k.quantity,w({type:"stock_quantity_select",payload:O}));case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function tt(){try{return p.serials[L][null==Re?void 0:Re.find((function(e){return e.boxId===pe}))]}catch(e){return[]}}var nt,lt=[{field:"checkbox",renderHeader:function(){return d().createElement(h.Z,{disabled:!0,indeterminate:p.selectedStock.length>0})},width:80,hideSortIcons:!0,disableColumnMenu:!0,filterable:!1,renderCell:function(e){var t,n;return d().createElement(h.Z,{onChange:function(){return function(e){return et.apply(this,arguments)}(e.row)},disabled:null===(t=e.row)||void 0===t||null===(n=t.tableMeta)||void 0===n?void 0:n.selectionDisabled,checked:$e(e.row)})}},{field:"boxId",width:150,headerName:Ae("boxId"),valueGetter:function(e){var t,n,l,r,a,i,o;return null!=e&&null!==(t=e.row)&&void 0!==t&&t.continuesRange&&"NON_SERIAL"!==(null==e||null===(n=e.row)||void 0===n||null===(l=n.itemRow)||void 0===l?void 0:l.reserveType)?null===(r=e.row.itemRow)||void 0===r||null===(a=r.ranges[0])||void 0===a||null===(i=a.batchId)||void 0===i?void 0:i.toString():null===(o=e.row.itemRow.batchIds)||void 0===o?void 0:o.toString()}},{field:"productSku",width:150,headerName:Ae("productSku"),valueGetter:function(e){var t;return null===(t=e.row.itemRow.productSku)||void 0===t?void 0:t.toString()}},{field:"reserveType",width:150,headerName:Ae("reserveType"),valueGetter:function(e){var t;return null===(t=e.row.itemRow.reserveType)||void 0===t?void 0:t.toString()}},{field:"serials",width:150,headerName:Ae("serials"),valueGetter:function(e){var t,n,l,r,a;return e.row.itemRow.serials&&e.row.itemRow.serials.length>0?null===(t=e.row.itemRow.serials)||void 0===t?void 0:t.toString():e.row.itemRow.ranges&&e.row.itemRow.ranges.length>0?"".concat(null===(n=e.row.itemRow)||void 0===n||null===(l=n.ranges[0])||void 0===l?void 0:l.startSerial," - ").concat(null===(r=e.row.itemRow)||void 0===r||null===(a=r.ranges[0])||void 0===a?void 0:a.endSerial):"-"}},{field:"quantity",width:150,sortable:!0,headerName:Ae("quantity"),valueGetter:function(e){var t,n,l,r,a,i,o,u,c,d,s,m;return"RANGE"===(null==e||null===(t=e.row)||void 0===t||null===(n=t.itemRow)||void 0===n?void 0:n.reserveType)?null!=e&&null!==(l=e.row)&&void 0!==l&&null!==(r=l.itemRow)&&void 0!==r&&null!==(a=r.ranges[0])&&void 0!==a&&a.quantity?null==e||null===(i=e.row)||void 0===i||null===(o=i.itemRow)||void 0===o||null===(u=o.ranges[0])||void 0===u||null===(c=u.quantity)||void 0===c?void 0:c.toString():1:null!=e&&null!==(d=e.row)&&void 0!==d&&d.itemRow.quantity?null==e||null===(s=e.row)||void 0===s||null===(m=s.itemRow.quantity)||void 0===m?void 0:m.toString():1}},{field:"",headerName:Ae("action"),width:400,filterable:!1,renderCell:function(e){var t,n,l,r,a,i,o,u;return null!=e&&null!==(t=e.row)&&void 0!==t&&t.continuesRange&&"NON_SERIAL"!==(null==e||null===(n=e.row)||void 0===n||null===(l=n.itemRow)||void 0===l?void 0:l.reserveType)?d().createElement(g.Z,{className:We.buttonWrapper},d().createElement(f.Z,{disabled:p.selectedStock.includes(e.row.boxId)||Ne===me,className:We.buttonWrapper,onClick:function(){return t=e.row,U(t.productSKU),pe=null==t||null===(n=t.itemRow)||void 0===n||null===(l=n.ranges[0])||void 0===l?void 0:l.batchId,ye.includes(pe)||ye.push(pe),xe(Re.concat(t)),G(t),void ee(!0);var t,n,l},color:Ge(e.row)?"secondary":"primary",variant:"outlined",startIcon:d().createElement(k.Z,{fontSize:"small"})},null!=e&&null!==(o=e.row)&&void 0!==o&&o.quantSelected?Ae("edit"):Ae("selectRange")),d().createElement(f.Z,{className:We.buttonWrapper,disabled:!Ge(e.row),onClick:function(){return ze(e.row)},color:Ge(e.row)?"primary":"secondary",variant:"outlined"},Ae("removeRange"))):"NON_SERIAL"===(null==e||null===(r=e.row)||void 0===r||null===(a=r.itemRow)||void 0===a?void 0:a.reserveType)?d().createElement(g.Z,{className:We.buttonWrapper},d().createElement(f.Z,{className:We.buttonWrapper,onClick:function(){return t=e.row,U(t.productSKU),G(t),void re(!0);var t},color:"secondary",variant:"outlined",startIcon:d().createElement(k.Z,{fontSize:"small"}),disabled:Ne===me},null!=e&&null!==(u=e.row)&&void 0!==u&&u.quantSelected?Ae("edit"):Ae("selectQuantity")),d().createElement(f.Z,{className:We.buttonWrapper,disabled:!Ge(e.row),onClick:function(){return He(e.row)},color:Ge(e.row)?"primary":"secondary",variant:"outlined"},Ae("removeQuantity"))):d().createElement(g.Z,{className:We.buttonWrapper},d().createElement(f.Z,{disabled:!(!p.selectedStock.includes(e.row.boxId)&&Ne!==me),className:We.buttonWrapper,onClick:function(){return t=e.row,pe=null==t?void 0:t.boxId,ye.includes(pe)||ye.push(pe),xe(Re.concat(t)),void Ze(!0);var t},color:Ge(e.row)?"secondary":"primary",variant:"outlined",startIcon:d().createElement(x.Z,{fontSize:"small"})},null!=e&&null!==(i=e.row)&&void 0!==i&&i.quantSelected?Ae("edit"):Ae("selectItems")),d().createElement(f.Z,{className:We.buttonWrapper,disabled:!Ge(e.row),onClick:function(){var t;return Ye(null===(t=e.row)||void 0===t?void 0:t.boxId)},color:Ge(e.row)?"secondary":"primary",variant:"outlined"},Ae("removeItems")))}}],rt=function(e){Te(e),w({type:"return_type",payload:e})};return d().createElement(d().Fragment,null,d().createElement("div",{style:{height:500}},d().createElement("section",{style:{display:"flex",justifyContent:"space-between",paddingRight:5,paddingLeft:5}},d().createElement("div",null,d().createElement(oe.Z,{value:Ne,exclusive:!0,onChange:function(e,t){qe(!je),t&&(Te(t),p.selectedSerials=[],p.selectedByRange=[],p.stockQuantity=[]),t===se&&(P&&P.length>0&&P.map((function(e,t){var n,l=null==e||null===(n=e.itemRow)||void 0===n?void 0:n.reserveType;if("SERIAL"!=l&&"BATCH"!=l||w({type:"set_serials",payload:{}}),"RANGE"===l){var r,a,i,o,u=p.serialRangeList,c=null===(r=e.itemRow)||void 0===r||null===(a=r.ranges[0])||void 0===a?void 0:a.batchId,d=null===(i=e.itemRow)||void 0===i||null===(o=i.ranges[0])||void 0===o?void 0:o.startSerial;if(!u[c])return;delete u[c][d],0===Object.keys(u[c]).length&&delete u[c];var s=p.selectedSerials.filter((function(e){return e!==d}));p.selectedByRange.filter((function(e){return e.startSerial!==d})),w({type:"remove_range_select",payload:{value:u,data:[],serial:s}})}"NON_SERIAL"==l&&w({type:"stock_quantity_select",payload:[]})})),rt(t)),t===me&&P&&P.length>0&&P.map(function(){var e=(0,r.Z)(u().mark((function e(t,n){var r,a,i,o,c,d,s,m,v,f,y,g,S,b,E,h,Z,I,R,x,k,O;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("NON_SERIAL"!==(a=null==t||null===(r=t.itemRow)||void 0===r?void 0:r.reserveType)&&ye.push(t.boxId),"RANGE"!==a){e.next=18;break}return f=t,y=null==t||null===(i=t.itemRow)||void 0===i?void 0:i.productSku,g=null==t||null===(o=t.itemRow)||void 0===o||null===(c=o.ranges[0])||void 0===c?void 0:c.batchId,S=null==t||null===(d=t.itemRow)||void 0===d||null===(s=d.ranges[0])||void 0===s?void 0:s.startSerial,b=null==t?void 0:t.inventoryList,E={startSerial:S,endSerial:null==t||null===(m=t.itemRow)||void 0===m||null===(v=m.ranges[0])||void 0===v?void 0:v.endSerial,quantity:(null==b?void 0:b.length)||"",boxId:g,productSKU:y},p.selectedByRange=p.selectedByRange.filter((function(e){return e.startSerial!==S})),p.selectedSerials=p.selectedSerials.filter((function(e){return e!==S})),h=de(de({},f),{},{startSerialSelected:"".concat(E.startSerial),endSerialSelected:"".concat(E.endSerial),productSKU:y,quantity:"".concat(BigInt(E.endSerial)-BigInt(E.startSerial)+BigInt("1"))}),Z=de({},p.serialRangeList),Object.keys(Z).includes("".concat(g))||(Z[g]={}),Z[g][S]=E,p.serialRangeList=Z,e.next=18,w({type:"stock_range_select",payload:{value:Z,data:h,serial:S}});case 18:"SERIAL"!=a&&"BATCH"!=a||t.inventoryList.length>0&&w({type:"box_item_selected",payload:{items:t.inventoryList.map((function(e){return e.serialNo})),boxId:t.boxId,productSKU:t.productSKU}}),"NON_SERIAL"==a&&((x=de(de({},t),{},{quantity:parseInt(null==t||null===(I=t.itemRow)||void 0===I||null===(R=I.quantity)||void 0===R?void 0:R.toString(),10)})).reserveType="NON_SERIAL",k=(0,l.Z)(p.stockQuantity),-1===(O=p.stockQuantity.findIndex((function(e){return e.productSKU===x.productSKU})))?k.push(x):k[O].quantity=x.quantity,w({type:"stock_quantity_select",payload:k}));case 20:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),rt(t)},"aria-label":"notification-mode"},d().createElement(ue.Z,{value:"PARTIAL","aria-label":"partialReturn"},d().createElement(y.ZP,{title:Ae("partialReturnHelper")},d().createElement(E.Z,null,Ae("partialReturn")))),d().createElement(ue.Z,{value:"FULL","aria-label":"fullReturn",disabled:Ue},d().createElement(y.ZP,{title:Ae("fullReturnHelper")},d().createElement(E.Z,null,Ae("fullReturn")))))),d().createElement("section",null,d().createElement(b.Z,{"aria-label":"cart",onClick:function(){return Se(!0)}},d().createElement(S.Z,{badgeContent:(0,X.e)(p),color:"primary"},d().createElement(I.Z,{fontSize:"large"}))))),d().createElement("div",null,d().createElement(v(),{loading:_,rows:(nt=(0,l.Z)(P),p.serialRangeList,(0,l.Z)(P),(0,l.Z)(p.selectedSerials),nt),getRowId:function(e){return e.boxId},columns:lt,columnBuffer:2,autoHeight:!0,onRowSelected:Ve,disableDensitySelector:!0,disableSelectionOnClick:!0,disableColumnFilter:!0,disableColumnMenu:!0,disableColumnReorder:!0,disableColumnSelector:!0,components:{LoadingOverlay:ve}}))),$?d().createElement(ie,{handleClose:function(){ee(!1)},handleSubmit:function(e,t,n,l){var r,a;e.boxId=null===(r=l.itemRow)||void 0===r||null===(a=r.ranges[0])||void 0===a?void 0:a.batchId;var i=de({},p.serialRangeList),o=Object.keys(i);p.selectedByRange=p.selectedByRange.filter((function(e){return e.startSerialSelected!==n})),p.selectedSerials=p.selectedSerials.filter((function(e){return e!==n}));var u=de(de({},l),{},{startSerialSelected:"".concat(e.startSerial),endSerialSelected:"".concat(e.endSerial),productSKU:L,quantity:"".concat(BigInt(e.endSerial)-BigInt(e.startSerial)+BigInt("1"))});o.includes("".concat(t))||(i[t]={}),i[t][n]=e,p.serialRangeList=i,w({type:"stock_range_select",payload:{value:i,data:u,serial:n}}),Me(Ae("itemAdded")),ee(!1)},product:de(de({},H),{},{productSKU:L}),inventoryList:null==Re||null===(n=Re.find((function(e){return e.boxId===pe})))||void 0===n?void 0:n.inventoryList,state:p}):null,ge&&d().createElement(F,{state:p,dispatch:w,onClose:function(){return Se(!1)},removeItem:Xe}),le&&d().createElement(J,{state:p,dispatch:w,selectedProduct:H,onClose:function(){return re(!1)},removeItem:Xe}),he&&d().createElement(W,{state:p,inventoryList:null==Re||null===(a=Re.find((function(e){return e.boxId===pe})))||void 0===a?void 0:a.inventoryList,boxId:null==Re||null===(o=Re.find((function(e){return e.boxId===pe})))||void 0===o?void 0:o.boxId,productSKU:null==Re||null===(m=Re.find((function(e){return e.boxId===pe})))||void 0===m?void 0:m.productSKU,dispatch:w,handleClose:function(){Ze(!1)}}))}},40135:(e,t,n)=>{"use strict";n.d(t,{Z:()=>W});var l=n(11746),r=n(74315),a=n(2411),i=n.n(a),o=n(60905),u=n(41262),c=n(4614),d=n(77277),s=n(8629),m=n(49429),v=n(38724),p=n(79249),f=n(76635),y=n(94339),g=n(24579),S=n(90436),b=(0,n(79692).Z)((function(e){return{space:{paddingRight:10,fontWeight:600},table:{minWidth:500},stepper:{minWidth:500,minHeight:500,height:"auto",marginTop:10},border:{borderBottom:"1px solid grey"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}})),E=function(e){var t=e.source,n=b();return i().createElement(y.Z,{variant:"outlined",style:{flex:1,padding:5,marginRight:10}},i().createElement(g.Z,null,i().createElement(S.Z,{style:{marginBottom:10,fontWeight:"bold"}}," Stock From "),i().createElement(S.Z,{title:"Name"},i().createElement("span",{className:n.space},"Name:"),t.resellerName),i().createElement(S.Z,{title:"Reseller ID"},i().createElement("span",{className:n.space},"Reseller ID:"),t.resellerId),i().createElement(S.Z,{title:"MSISDN"},i().createElement("span",{className:n.space},"Reseller MSISDN:"),t.resellerMSISDN)))},h=function(e){var t=e.destination,n=b();return i().createElement(y.Z,{variant:"outlined",style:{flex:1,padding:5,marginLeft:10}},i().createElement(g.Z,null,i().createElement(S.Z,{style:{marginBottom:10,fontWeight:"bold"}}," Stock To "),i().createElement(S.Z,{title:"Name"},i().createElement("span",{className:n.space},"Name:"),t.resellerName),i().createElement(S.Z,{title:"Reseller ID"},i().createElement("span",{className:n.space},"Reseller ID:"),t.resellerId),i().createElement(S.Z,{title:"Reseller MSISDN"},i().createElement("span",{className:n.space},"Reseller MSISDN:"),t.resellerMSISDN)))},Z=n(97485),w=n(15584),I=n(91256),R=n(58987),x=n(89571),k=n(33553),O=n(37390),N=n(80030),T=n(75696),C=n(64659),P=n(4730),j=n(51119),q=n(24235);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,j.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=function(){function e(t,n,l,r,a){(0,C.Z)(this,e),(0,j.Z)(this,"lineItems",void 0),(0,j.Z)(this,"pricingData",void 0),(0,j.Z)(this,"taxList",void 0),(0,j.Z)(this,"products",[]),(0,j.Z)(this,"discount",null),this.lineItems=t,this.pricingData=n,this.taxList=l,this.products=r,this.discount=a}return(0,P.Z)(e,[{key:"getTax",value:function(e){return this.taxList.find((function(t){return t.id===e}))}},{key:"getPenalty",value:function(e){return(0,q.JU)(this.pricingData,e.productSKU)}},{key:"getPrice",value:function(e){return e.price?e.price:(0,q.Jz)(this.products,e.productSKU).amount}},{key:"getNetAmount",value:function(e){return e.amount?e.amount:e.price?e.price*e.quantity:this.getPrice(e)*e.quantity}},{key:"getTaxes",value:function(e){var t=this,n=(0,q.KJ)(this.products,this.taxList,e.productSKU);return 0===n.length?[{name:"N/A",amount:0,description:"Not applicable"}]:n.map((function(n){var l=0===n.percentValue?"".concat(n.fixedValue," "):"".concat(n.percentValue," %");return{name:"".concat(n.taxType," ").concat(l),amount:t.calculateTax(e,n),description:n.description}}))}},{key:"calculateTax",value:function(e,t){var n=this.getNetAmount(e);return 0!==t.percentValue?n*t.percentValue/100:t.fixedValue}},{key:"getPostTaxAmount",value:function(e){var t=this.getTaxes(e).reduce((function(e,t){return e+t.amount}),0);return this.getNetAmount(e)-this.getPenalty(e)+t}},{key:"totalCalucaltion",get:function(){var e=this.rows,t=e.reduce((function(e,t){return e+t.taxes.reduce((function(e,t){return e+t.amount}),0)}),0),n=e.reduce((function(e,t){return e+t.netAmount}),0),l=e.reduce((function(e,t){return e+t.quantity}),0),r=e.reduce((function(e,t){return e+t.penalty}),0);return{totalAmount:e.reduce((function(e,t){return e+t.postTaxAmount}),0),totalTax:t,subTotal:n,totalQuantity:l,totalDiscount:r}}},{key:"rows",get:function(){var e=this;return this.lineItems.map((function(t){return L(L({},t),{},{price:e.getPrice(t),penalty:e.getPenalty(t),taxes:e.getTaxes(t),netAmount:e.getNetAmount(t),postTaxAmount:e.getPostTaxAmount(t)})}))}}]),e}(),K=n(63135),A=(0,T.makeStyles)((function(e){return(0,T.createStyles)({container:{},table:{minWidth:650},tableBody:{"& td":{border:".8px solid #d3d3d369"}},tableHead:{backgroundColor:"#607d8b;","& th":{color:"white","text-align":"center",border:".8px solid #d3d3d369"}},tableHeadRowCell:{color:"white"},totalTitles:{fontWeight:"bold"}})}));const _=function(e){e.data1;var t,n,l,r,o,u,c,d,s,m,v,p,f,y,g,S,b,E,h=e.paymentInfo,T=void 0!==h&&h,C=e.taxes,P=void 0===C?[]:C,j=e.itemRows,q=void 0===j?[]:j,B=e.products,L=void 0===B?[]:B,_=e.discount,D=void 0===_?0:_,M=e.dispatch,F=e.pricingData,W=void 0===F?[]:F,Q=e.newItemRows,z=A(),H=(0,K.useTranslation)().t,G=new U(q,W,P,L,D).totalCalucaltion;return(0,a.useEffect)((function(){T&&M&&M({type:"total_amount",payload:{key:"invoiceAmount",value:G.totalAmount}})}),[]),i().createElement(I.Z,{component:k.Z,className:z.container},i().createElement(O.Z,{className:z.table,size:"medium","aria-label":"a dense table"},i().createElement(R.Z,{className:z.tableHead},i().createElement(x.Z,null,i().createElement(w.Z,null,H("srNo")),i().createElement(w.Z,null,H("productSku")),i().createElement(w.Z,null,H("boxId")),T&&i().createElement(w.Z,null,H("price")),i().createElement(w.Z,null,H("quantity")),T?i().createElement(i().Fragment,null,i().createElement(w.Z,null,H("netAmount")),i().createElement(w.Z,null,H("penalty")),i().createElement(w.Z,null,H("tax")),i().createElement(w.Z,null,H("taxAmount")),i().createElement(w.Z,null,H("payableAmountForOrder"))):null)),i().createElement(Z.Z,{className:z.tableBody},Q?null==Q||null===(t=Q.creditNoteEntryList)||void 0===t?void 0:t.map((function(e,t){var n,l,r,a,o,u,c,d,s,m,v,p,f,y,g,S;return i().createElement(x.Z,{key:t},i().createElement(w.Z,{width:30}," ",t+1),i().createElement(w.Z,{width:230},null==e?void 0:e.productSKU),i().createElement(w.Z,{width:230},(null==e?void 0:e.boxId)||"-"),T&&i().createElement(w.Z,{width:100,align:"right"},null==e||null===(n=e.unitPrice)||void 0===n?void 0:n.amount," ",null==e||null===(l=e.unitPrice)||void 0===l?void 0:l.currency),i().createElement(w.Z,{width:100,align:"right"},null==e||null===(r=e.uom)||void 0===r?void 0:r.quantity),T?i().createElement(i().Fragment,null,i().createElement(w.Z,{width:250,align:"right"},null==e||null===(a=e.totalPrice)||void 0===a?void 0:a.amount," ",null==e||null===(o=e.totalPrice)||void 0===o?void 0:o.currency),i().createElement(w.Z,{width:250,align:"right"},null==e||null===(u=e.penalty)||void 0===u?void 0:u.amount," ",null==e||null===(c=e.penalty)||void 0===c?void 0:c.currency),i().createElement(w.Z,{width:130,align:"center"},i().createElement("section",null,null==e||null===(d=e.taxDetails)||void 0===d?void 0:d.map((function(t,n){var l;return i().createElement("div",{key:n,title:null==t?void 0:t.taxType,style:{padding:5,borderBottom:1===(null==e||null===(l=e.taxDetails)||void 0===l?void 0:l.length)?"unset":".2px solid lightgrey"}},i().createElement(N.ZP,{title:null==t?void 0:t.taxType},i().createElement("span",null,null==t?void 0:t.taxType," ",null==t?void 0:t.percentValue,"%")))})))),i().createElement(w.Z,{width:130,align:"right"},e&&null!=e&&e.calculatedTax&&null!=e&&null!==(s=e.calculatedTax)&&void 0!==s&&s.amount?(null===(m=Number.parseFloat(null==e||null===(v=e.calculatedTax)||void 0===v||null===(p=v.amount)||void 0===p?void 0:p.toString()))||void 0===m?void 0:m.toFixed(4))+" "+(null==e||null===(f=e.calculatedTax)||void 0===f?void 0:f.currency):""),i().createElement(w.Z,{align:"right",width:250,style:{verticalAlign:1===(null==e||null===(y=e.taxes)||void 0===y?void 0:y.length)?"bottom":"center"}},null==e||null===(g=e.netPrice)||void 0===g?void 0:g.amount," ",null==e||null===(S=e.netPrice)||void 0===S?void 0:S.currency)):null)})):"",T?i().createElement(i().Fragment,null,i().createElement(x.Z,null,i().createElement(w.Z,{rowSpan:4}),i().createElement(w.Z,{rowSpan:4}),i().createElement(w.Z,{rowSpan:4}),i().createElement(w.Z,{rowSpan:4}),i().createElement(w.Z,{rowSpan:4}),i().createElement(w.Z,{rowSpan:4}),i().createElement(w.Z,{rowSpan:4}),i().createElement(w.Z,{colSpan:2,className:z.totalTitles},H("subtotal")),i().createElement(w.Z,{align:"right",className:z.totalTitles},Q&&null!=Q&&Q.totalPrice&&null!=Q&&null!==(n=Q.totalPrice)&&void 0!==n&&n.amount?(null===(l=Number.parseFloat(null==Q||null===(r=Q.totalPrice)||void 0===r||null===(o=r.amount)||void 0===o?void 0:o.toString()))||void 0===l?void 0:l.toFixed(4))+" "+(null==Q||null===(u=Q.totalPrice)||void 0===u?void 0:u.currency):"")),Q&&null!=Q&&Q.totalPenalty?i().createElement(x.Z,null,i().createElement(w.Z,{colSpan:2,className:z.totalTitles},H("penalty")),i().createElement(w.Z,{style:{backgroundColor:"rgb(255 40 26 / 26%)"},align:"right",className:z.totalTitles},null==Q||null===(c=Q.totalPenalty)||void 0===c?void 0:c.amount," ",null==Q||null===(d=Q.totalPenalty)||void 0===d?void 0:d.currency)):null,i().createElement(x.Z,null,i().createElement(w.Z,{colSpan:2,className:z.totalTitles},H("tax")),i().createElement(w.Z,{align:"right",className:z.totalTitles},Q&&null!=Q&&Q.totalTax&&null!=Q&&null!==(s=Q.totalTax)&&void 0!==s&&s.amount?(null===(m=Number.parseFloat(null==Q||null===(v=Q.totalTax)||void 0===v||null===(p=v.amount)||void 0===p?void 0:p.toString()))||void 0===m?void 0:m.toFixed(4))+" "+(null==Q||null===(f=Q.totalTax)||void 0===f?void 0:f.currency):"")),i().createElement(x.Z,null,i().createElement(w.Z,{colSpan:2,className:z.totalTitles},H("totalAmountForOrder")),i().createElement(w.Z,{align:"right",className:z.totalTitles},Q&&null!=Q&&Q.totalNetPrice&&null!=Q&&null!==(y=Q.totalNetPrice)&&void 0!==y&&y.amount?(null===(g=Number.parseFloat(null==Q||null===(S=Q.totalNetPrice)||void 0===S||null===(b=S.amount)||void 0===b?void 0:b.toString()))||void 0===g?void 0:g.toFixed(4))+" "+(null==Q||null===(E=Q.totalNetPrice)||void 0===E?void 0:E.currency):""))):i().createElement(i().Fragment,null,i().createElement(x.Z,null,i().createElement(w.Z,{rowSpan:3}),i().createElement(w.Z,{rowSpan:3}),T&&i().createElement(w.Z,{rowSpan:3}),i().createElement(w.Z,{colSpan:1,className:z.totalTitles},H("taxQuantity")),i().createElement(w.Z,{align:"right",className:z.totalTitles},G.totalQuantity))))))};var D=n(23664),M=n(29e3),F=n(61715);const W=function(e){var t=e.dataAPI,n=e.state,y=e.from,g=e.to,S=e.paymentInfo,Z=void 0!==S&&S,w=e.itemList,I=e.dispatch,R=b(),x=(0,a.useState)(!1),k=(0,r.Z)(x,2),O=k[0],N=k[1],T=(0,a.useState)(null),C=(0,r.Z)(T,2),P=C[0],j=(C[1],(0,a.useState)(!1)),B=(0,r.Z)(j,2),L=B[0],U=B[1],A=(0,K.useTranslation)().t,W=(0,a.useState)(!1),Q=(0,r.Z)(W,2),z=Q[0],H=Q[1],G=(0,a.useState)(),V=(0,r.Z)(G,2),J=V[0],X=(V[1],(0,D.Z)().showErrorMessage),Y=(0,a.useState)([]),$=(0,r.Z)(Y,2),ee=$[0],te=$[1],ne=(0,a.useState)([]),le=(0,r.Z)(ne,2),re=le[0],ae=le[1];return(0,a.useEffect)((function(){var e,t,l,r=null===(e=window)||void 0===e||null===(t=e.config)||void 0===t||null===(l=t.order)||void 0===l?void 0:l.addtionalInformation;r&&(U(r.enabled&&r.fields.map((function(e){return e.orderType})).flat().includes(n.orderType)),te(r.fields.filter((function(e){var t;return null===(t=e.orderType)||void 0===t?void 0:t.includes(n.orderType)}))||[]))}),[n.orderType]),(0,a.useEffect)((function(){Z&&(N(!0),(0,F.xO)(t).then((function(e){var t;0===(null==e?void 0:e.resultCode)?ae(null!=e&&e.creditNotes&&null!=e&&null!==(t=e.creditNotes)&&void 0!==t&&t.length?null==e?void 0:e.creditNotes[0]:[]):X(null==e?void 0:e.resultMessage)})).catch((function(e){N(!1)})).finally((function(){return N(!1)})))}),[Z]),i().createElement(i().Fragment,null,i().createElement(u.Z,{className:R.backdrop,open:O},i().createElement(c.Z,{color:"inherit"})),L&&i().createElement("section",{style:{overflow:"hidden",marginBottom:15}},i().createElement(d.Z,{variant:"outlined",color:"primary",onClick:function(){return H(!0)},style:{float:"right"}},A("AddtionalInfo","Addtional information"))),z&&i().createElement(i().Fragment,null,i().createElement(s.Z,{open:!0,scroll:"body",fullWidth:!0,maxWidth:"sm",disableBackdropClick:!0},i().createElement(p.Z,{id:"scroll-dialog-title"},A("additionalInformation","Additional Information")),i().createElement(v.Z,{dividers:!0},i().createElement(M.Z,{data:ee,setData:te})),i().createElement(m.Z,null,i().createElement(d.Z,{onClick:function(){return H(!1)}},A("cancel","Cancel")),i().createElement(d.Z,{color:"primary",variant:"contained",onClick:function(){if(I){var e=n.additionalFields.filter((function(e){return"invoiceAmount"===e.key})).concat((0,l.Z)(ee));I({type:"set_addtional_info",payload:e})}H(!1)}},A("submit","Submit"))))),i().createElement("section",{style:{marginTop:10}},i().createElement(o.Z,{container:!0,justify:"space-between"},i().createElement(E,{source:y}),i().createElement(h,{destination:g}))),i().createElement("div",{className:R.stepper},i().createElement(_,{data1:t,itemRows:function(){if(w&&w.length>0)return w;var e,t,r=n.selectedByRange,a=n.stockRows,i=n.serials,o=r.concat(a).map((function(e){var t;return{productSKU:e.productSKU,quantity:parseInt(e.quantity,10),boxId:e.boxId,price:null===(t=e.unitPrice)||void 0===t?void 0:t.price}})),u=Object.keys(i).map((function(e){return Object.keys(i[e]).map((function(t){return{productSKU:e,quantity:i[e][t].length,boxId:t,price:(l=e,null===(r=(0,q.Jz)(n.products,l))||void 0===r?void 0:r.amount)};var l,r}))})).flat(),c=(e=n.services.topups,t=(0,f.groupBy)(e,"productSKU"),Object.keys(t).map((function(e){return{productSKU:e,quantity:t[e].length,boxId:"-",reserverType:"TOPUP",amount:t[e].reduce((function(e,t){return e+parseInt(t.amount)}),0)}})));return[].concat((0,l.Z)(o),(0,l.Z)(u),(0,l.Z)(c))}(),taxes:n.taxes,products:n.products,pricingData:J,paymentInfo:Z,discount:P,dispatch:I,newItemRows:re})))}},13278:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var l=n(51119),r=n(74315),a=n(2411),i=n.n(a),o=n(86619),u=n(77277),c=n(21324),d=n(41744),s=n.n(d),m=n(21602),v=n(21853),p=n(63135),f=n(13029),y=n(19985),g=n(23664);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E={},h=null,Z={};const w=function(e){var t,n,d=e.dispatch,S=e.state,w=e.resellerId,I=e.resellerType,R=e.selectedItem,x=void 0===R?null==S||null===(t=S.returnOrder)||void 0===t?void 0:t.orderId:R,k=e.supportedOrderTypes,O=e.onselect,N=void 0===O?null:O,T=(0,m.Z)(),C=null==T?void 0:T.resellerPath.split("/"),P=C.length-2,j=(0,a.useState)(""),q=(0,r.Z)(j,2),B=q[0],L=q[1],U=(0,a.useState)(!1),K=(0,r.Z)(U,2),A=K[0],_=K[1],D=i().useState([]),M=(0,r.Z)(D,2),F=M[0],W=M[1],Q=(0,a.useState)(20),z=(0,r.Z)(Q,2),H=z[0],G=z[1],V=(0,a.useState)(1),J=(0,r.Z)(V,2),X=J[0],Y=J[1],$=(0,a.useState)("desc"),ee=(0,r.Z)($,2),te=ee[0],ne=ee[1],le=(0,a.useState)("createTimestamp"),re=(0,r.Z)(le,2),ae=re[0],ie=re[1],oe=(n={orderType:k},(0,l.Z)(n,I,[w,C[P]]),(0,l.Z)(n,"state","TRANSFERRED"),(0,l.Z)(n,"fetchReturnableOrders","true"),n),ue=(0,a.useState)(oe),ce=(0,r.Z)(ue,2),de=ce[0],se=ce[1],me=(0,a.useState)(),ve=(0,r.Z)(me,2),pe=ve[0],fe=ve[1],ye=i().useState(),ge=(0,r.Z)(ye,2),Se=ge[0],be=(ge[1],(0,g.Z)().showErrorMessage),Ee=(0,p.useTranslation)().t;i().useEffect((function(){S.selectedSerials=[],S.selectedByRange=[],S.stockQuantity=[],S.serialRangeList={},d({type:"set_serials",payload:{}})}),[]);var he=[{field:"checkbox",renderHeader:function(){return i().createElement(c.Z,{disabled:!0})},width:80,hideSortIcons:!0,disableColumnMenu:!0,sortable:!1,filterable:!1,renderCell:function(e){var t,n;return i().createElement(c.Z,{onChange:function(){return Ze(null==e?void 0:e.row)},checked:null===(t=[x])||void 0===t?void 0:t.includes(null==e||null===(n=e.row)||void 0===n?void 0:n.orderId)})}},{field:"orderId",headerName:Ee("orderId"),sortable:!0,flex:2},{field:"orderType",headerName:Ee("orderType"),sortable:!0,flex:1},{field:"paymentMode",headerName:Ee("paymentMode"),sortable:!0,flex:1},{field:"state",headerName:Ee("state"),sortable:!0,flex:1},{field:"createTimestamp",headerName:Ee("createTimestamp"),sortable:!0,flex:1,type:"date"}];function Ze(e){if(!N||!N(e)){var t=null==e?void 0:e.seller,n=null==e?void 0:e.seller,l=null==e?void 0:e.buyer,r=null==e?void 0:e.receiver;d({type:"order_select",payload:e}),d({type:"seller_select",payload:{resellerId:null==t?void 0:t.id,resellerMSISDN:null==t?void 0:t.msisdn,resellerName:null==t?void 0:t.name}}),d({type:"sender_select",payload:{resellerId:null==n?void 0:n.id,resellerMSISDN:null==n?void 0:n.msisdn,resellerName:null==n?void 0:n.name}}),d({type:"buyer_select",payload:{resellerId:null==l?void 0:l.id,resellerMSISDN:null==l?void 0:l.msisdn,resellerName:null==l?void 0:l.name}}),d({type:"receiver_select",payload:{resellerId:null==r?void 0:r.id,resellerMSISDN:null==r?void 0:r.msisdn,resellerName:null==r?void 0:r.name}})}}var we=(0,a.useCallback)((function(){if(B){var e,t=(e={orderId:B,orderType:k},(0,l.Z)(e,I,[w,C[P]]),(0,l.Z)(e,"state","TRANSFERRED"),(0,l.Z)(e,"fetchReturnableOrders","true"),e);E=(0,y.N0)(t)}else E=(0,y.N0)(de);var n={sort:"".concat(ae,"_").concat(null==te?void 0:te.toLowerCase()),page:E===Z?X:1,perPage:H,filter:E};_(!0),(0,f.Fw)(n).then((function(e){W(e.orders),fe(e.metadata),Z=E})).catch((function(e){_(!1),be(e)})).finally((function(){return _(!1)}))}),[ae,te,X,H,de,Se,B]);(0,a.useEffect)((function(){we()}),[we]);var Ie=(0,a.useCallback)((function(e){var t=e.filterModel.items[0].value?e.filterModel.items[0].value:"",n=e.filterModel.items[0].columnField;if(h&&clearTimeout(h),""===t)return se(oe);h=setTimeout((function(){se(b(b({},de),{},(0,l.Z)({},n,t))),Y(1)}),800)}),[]),Re=(0,a.useCallback)((function(e){var t=e.sortModel[0].field,n=e.sortModel[0].sort;ie(t),ne(n)}),[]);return i().createElement("section",{style:{display:"flex",justifyContent:"center",flexDirection:"column"}},i().createElement("section",{style:{alignSelf:"center"}},i().createElement(o.Z,{style:{width:400},label:Ee("orderId"),value:B,onChange:function(e){L(e.target.value)}}),i().createElement(u.Z,{style:{height:32},onClick:we,endIcon:i().createElement(v.Z,{fontSize:"large"})},Ee("search"))),i().createElement("section",{style:{height:"calc(90vh - 250px)",width:"100%"}},i().createElement(s(),{loading:A,getRowId:function(e){return null==e?void 0:e.orderId},rows:F,columns:he,disableSelectionOnClick:!0,onRowSelected:Ze,selectionModel:[x],pageSize:H,pagination:!0,page:X-1,onPageChange:function(e){Y(e.page+1)},onPageSizeChange:function(e){G(e.pageSize)},rowCount:(null==pe?void 0:pe.totalCount)||1,onFilterModelChange:Ie,onSortModelChange:Re,filterMode:"server",paginationMode:"server",sortingMode:"server"})))}},28247:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var l=n(82609),r=n.n(l)()((function(e){return e[1]}));r.push([e.id,"input[type=number]::-webkit-inner-spin-button, \ninput[type=number]::-webkit-outer-spin-button { \n    -webkit-appearance: none;\n    -moz-appearance: none;\n    appearance: none;\n    margin: 0; \n}\n\ninput[type=number]::-webkit-outer-spin-button,\ninput[type=number]::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n}\n\ninput[type=number] {\n    -moz-appearance:textfield;\n}\n\ndiv[role=tooltip] {\n    position: absolute;\n    will-change: transform;\n    top: 0px;\n    left: 0px;\n    transform: translate3d(222px, 465px, 0px);\n    z-index: 2000;\n}",""]);const a=r}}]);