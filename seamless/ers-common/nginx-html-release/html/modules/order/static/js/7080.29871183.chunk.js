(self.webpackChunk_unified_order=self.webpackChunk_unified_order||[]).push([[7080],{27080:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>C});var l=t(11746),n=t(51119),a=t(74315),s=t(2411),i=t.n(s),o=t(12783),u=t(6277),c=t(21602),d=t(33553),p=t(23664),m=t(75696),f=t(48049),v=t(4409),y=t(91787),b=t(13432),S=t(28358),I=t(13029),g=t(24235),h=t(13268),N=t(61990),Z=t(52612),E=t(54867),w=t(34859),D=t(63135);function O(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,l)}return t}function P(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?O(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var M=(0,m.makeStyles)((function(e){return(0,m.createStyles)({element:{margin:e.spacing(1),padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1.5),"px"),borderRadius:e.shape.borderRadius},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},btnPrimary:{background:e.palette.primary.main,color:e.palette.primary.contrastText},decisionWrapper:{marginLeft:e.spacing(1),padding:"".concat(e.spacing(3),"px ").concat(e.spacing(1),"px")}})})),k={name:"",phone:"",address:""},j=function(e){var r,t,l,n=e.dispatch,a=e.state,s=e.inventoryReseller,o=(0,c.Z)(),u=null==a||null===(r=a.seller)||void 0===r?void 0:r.resellerId;return"parentInventory"==s&&(u=null==o||null===(t=o.info)||void 0===t||null===(l=t.resellerData)||void 0===l?void 0:l.parentResellerId),i().createElement(N.Z,{resellerId:u||null,state:a,dispatch:n})},x=function(e){var r,t=e.state,l=e.dispatch,n=null!==(r=t.buyer)&&void 0!==r&&r.resellerId?[t.buyer.resellerId]:[];return i().createElement(b.Z,{onSelectReseller:function(e){l({type:"buyer_select",payload:e})},selectedItems:n})};const C=function(e){var r,t,n=e.state,m=e.dispatch,b=(0,D.useTranslation)().t,N=(0,c.Z)(),O=(0,p.Z)(),C=O.showSuccessMessage,_=O.showErrorMessage,R=(0,s.useState)(!1),F=(0,a.Z)(R,2),q=F[0],z=F[1],B=(0,s.useState)(!0),T=(0,a.Z)(B,2),A=T[0],H=T[1],L=(0,s.useState)(),W=(0,a.Z)(L,2),G=W[0],J=W[1],K=(0,s.useState)(!1),Q=(0,a.Z)(K,2),U=Q[0],V=Q[1],X=(0,s.useState)(!1),Y=(0,a.Z)(X,2),$=Y[0],ee=Y[1],re=i().useState("ownInventory"),te=(0,a.Z)(re,2),le=te[0],ne=te[1],ae=(0,s.useState)(!1),se=(0,a.Z)(ae,2),ie=se[0],oe=se[1],ue=(0,s.useState)([{label:b("inventory")},{label:b("selectStock")},{label:b("selectBuyer")},{label:b("additionalInfo")},{label:b("paymentDetails")},{label:b("orderDetail")}]),ce=(0,a.Z)(ue,2),de=ce[0],pe=ce[1],me=(0,s.useState)(n.subscriberAdditionalFields||k),fe=(0,a.Z)(me,2),ve=fe[0],ye=fe[1],be=M(),Se=(0,f.useHistory)(),Ie=null===(r=window.config.order)||void 0===r?void 0:r.employeeSnicCategory,ge=(0,E.Z)(null==N?void 0:N.info),he=(null===(t=window.config)||void 0===t?void 0:t.order).subscriberTypes,Ne=void 0===he?[]:he;function Ze(){z(!0);var e=(0,Z.requestHelper)(n,N,le);return V(!0),(0,I.ry)(e).then((function(e){0===e.resultCode?(C(e),J({message:e.resultMessage,kind:"success"}),V(!1)):(z(!1),_(e))})).catch((function(e){z(!1),_(e)}))}function Ee(e){switch(e){case 0:return De()?$:!(0,g.z3)(n);case 1:return De()?!(0,g.z3)(n):null===n.buyer;case 2:if(De())return null===n.buyer;if(we())return A;case 3:if(we())return A;case 4:return!(n.paymentAgreement&&n.paymentMode);default:return!1}}(0,s.useEffect)((function(){m({type:"seller_select",payload:{resellerId:null==N?void 0:N.requestedPrincipalId,resellerMSISDN:null==N?void 0:N.targetMSISDN,resellerName:null==N?void 0:N.targetPrincipalName}})}),[N]);var we=function(){return!!n.buyer&&Ne.includes(n.buyer.resellerTypeName)},De=function(){return ge===Ie};(0,s.useEffect)((function(){var e=(0,l.Z)(de);if(De()||(e=e.filter((function(e){return e.label!==b("inventory")}))),we())return pe(e);pe(e.filter((function(e){return e.label!==b("additionalInfo")})))}),[N]);var Oe,Pe,Me=(0,Z.requestHelper)(n,N,le);return i().createElement(i().Fragment,null,q&&i().createElement(y.Z,{loading:U,orderMessage:G,handleClose:function(){z(!1),m({type:"reset",payload:null}),Se.push("/home/order/orders")}}),i().createElement(o.SeamlessStepper,{steps:de,components:{Control:function(e){e.goFirst;var r=e.goNext,t=e.goPrev,l=e.disableFirst,n=e.disableLast,a=e.view;return i().createElement(d.Z,null,i().createElement(o.SeamlessButton,{onClick:t,disabled:l,className:(0,u.default)(be.element,be.btnPrimary),color:"primary",variant:"contained"},b("previous")),i().createElement(o.SeamlessButton,{className:(0,u.default)(be.element,be.btnPrimary),onClick:function(){!function(e,r){de[r].label==b("additionalInfo")&&m({type:"subscriber_additional_fields",payload:P({},ve)}),e()}(r,a)},disabled:n||Ee(a),color:"primary",variant:"contained"},b("next")),n&&i().createElement(o.SeamlessButton,{className:(0,u.default)(be.element),onClick:Ze,color:"primary",variant:"contained",disabled:ie},b("submit")))}}},De()&&i().createElement(d.Z,{className:be.decisionWrapper},i().createElement(w.Z,{options:[{label:b("ownInventory"),value:"ownInventory"},{label:b("parentInventory"),value:"parentInventory"}],value:le,onSelect:function(e){ee(!1),ne(e);var r,t,l,n,a={resellerId:null==N?void 0:N.requestedPrincipalId,resellerMSISDN:null==N?void 0:N.targetMSISDN,resellerName:null==N?void 0:N.targetPrincipalName};"parentInventory"==e&&(a={resellerId:null==N||null===(r=N.info)||void 0===r||null===(t=r.resellerData)||void 0===t?void 0:t.parentResellerId,resellerMSISDN:"",resellerName:null==N||null===(l=N.info)||void 0===l||null===(n=l.resellerData)||void 0===n?void 0:n.parentResellerName}),m({type:"seller_select",payload:a})}})),i().createElement(j,{dispatch:m,state:n,inventoryReseller:le}),i().createElement(x,{dispatch:m,state:n}),we()&&i().createElement(S.Z,{data:ve,state:n,onFormSubmit:function(e){ye(e)},validateFields:function(e){return H(e.length>0)}}),i().createElement(v.Z,{state:n,dispatch:m}),i().createElement(h.Z,{dataAPI:Me,paymentInfo:!0,state:n,from:(Pe=null==n?void 0:n.seller,{resellerId:null==Pe?void 0:Pe.resellerId,resellerMSISDN:null==Pe?void 0:Pe.resellerMSISDN,resellerName:null==Pe?void 0:Pe.resellerName}),to:(Oe=null==n?void 0:n.buyer,{resellerId:null==Oe?void 0:Oe.resellerId,resellerMSISDN:null==Oe?void 0:Oe.resellerMSISDN,resellerName:null==Oe?void 0:Oe.resellerName}),dispatch:m,setDisableSubmit:oe})))}}}]);