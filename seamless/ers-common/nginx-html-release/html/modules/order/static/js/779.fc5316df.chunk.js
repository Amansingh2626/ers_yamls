(self.webpackChunk_unified_order=self.webpackChunk_unified_order||[]).push([[779],{70779:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>D});var l=t(74315),s=t(12783),a=t(2411),n=t.n(a),i=t(6277),o=t(21602),u=t(13268),c=t(33553),d=t(23664),m=t(75696),p=t(99960),f=t(67757),S=t(13029),v=t(13432),I=t(4409),b=t(48049),h=t(91787),y=t(61990),g=t(24235),N=t(63135),E=t(94554),Z=t(76635),k=(0,m.makeStyles)((function(e){return(0,m.createStyles)({element:{margin:e.spacing(1)},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}})})),M=function(e){var r,t=e.dispatch,l=e.state;return n().createElement(y.Z,{resellerId:(null==l||null===(r=l.seller)||void 0===r?void 0:r.resellerId)||null,state:l,dispatch:t})},C=function(e){var r,t=e.state,l=e.dispatch,s=null!==(r=t.seller)&&void 0!==r&&r.resellerId?[t.seller.resellerId]:[];return n().createElement(v.Z,{onSelectReseller:function(e){l({type:"seller_select",payload:e})},selectedItems:s})};const D=function(e){var r=e.state,t=e.dispatch,m=(0,o.Z)(),v=(0,d.Z)(),y=v.showSuccessMessage,D=v.showErrorMessage,w=k(),P=(0,a.useState)(!1),_=(0,l.Z)(P,2),q=_[0],H=_[1],x=(0,a.useState)(),B=(0,l.Z)(x,2),F=B[0],z=B[1],A=(0,a.useState)(!1),L=(0,l.Z)(A,2),R=(L[0],L[1]),T=(0,a.useState)(!1),j=(0,l.Z)(T,2),G=j[0],J=j[1],K=(0,b.useHistory)(),O=(0,N.useTranslation)().t;(0,a.useEffect)((function(){t({type:"buyer_select",payload:{resellerId:m.requestedPrincipalId,resellerMSISDN:m.targetMSISDN,resellerName:m.targetPrincipalName}})}),[m]);var Q=[{label:O("selectSeller")},{label:O("selectStock")},{label:O("paymentDetails")},{label:O("orderDetails")},{label:O("paymentConfirmation")}];function U(){H(!0);var e=(0,p.requestHelper)(r);return R(!0),(0,S.ry)(e).then((function(e){0===e.resultCode?(y(e),z({message:e.resultMessage,kind:"success"}),R(!1)):(D(e),H(!1))})).catch((function(e){H(!1),D(e)}))}function V(e){switch(e){case 0:return null===r.seller;case 1:return!(0,g.z3)(r);default:return!1}}var W,X,Y,$,ee=(0,p.requestHelper)(r);return(W=r.groups,X=W.map((function(e){return(0,E.g8)(e).then((function(e){return e.group.members}))})),Promise.all(X)).then((function(e){var t=Array.from((0,Z.uniqBy)(e.flat(),"userId")).filter((function(e){return"member"===e.memberType})).map((function(e){return{id:e.userId,additionalFields:[]}}));return Promise.resolve((0,f.requestHelper)(r,t))})),n().createElement(n().Fragment,null,q&&n().createElement(h.Z,{loading:q,orderMessage:F,handleClose:function(){H(!1),t({type:"reset",payload:null}),K.push("/home/order/orders")}}),n().createElement(s.SeamlessStepper,{steps:Q,components:{Control:function(e){e.goFirst;var r=e.goNext,t=e.goPrev,l=e.disableFirst,a=e.disableLast,o=e.view;return n().createElement(c.Z,null,n().createElement(s.SeamlessButton,{onClick:t,disabled:l,className:(0,i.default)(w.element),color:"primary",variant:"contained"},O("previous")),n().createElement(s.SeamlessButton,{className:(0,i.default)(w.element),onClick:r,disabled:a||V(o),color:"primary",variant:"contained"},O("next")),a&&n().createElement(s.SeamlessButton,{className:(0,i.default)(w.element),onClick:U,color:"primary",variant:"contained",disabled:G},O("submit")))}}},n().createElement(C,{dispatch:t,state:r}),n().createElement(M,{dispatch:t,state:r}),n().createElement(I.Z,{state:r,dispatch:t}),n().createElement(u.Z,{dataAPI:ee,paymentInfo:!0,state:r,from:($=null==r?void 0:r.seller,{resellerId:null==$?void 0:$.resellerId,resellerMSISDN:null==$?void 0:$.resellerMSISDN,resellerName:null==$?void 0:$.resellerName}),to:(Y=null==r?void 0:r.buyer,{resellerId:null==Y?void 0:Y.resellerId,resellerMSISDN:null==Y?void 0:Y.resellerMSISDN,resellerName:null==Y?void 0:Y.resellerName}),itemList:(0,g.RH)(r),dispatch:t,setDisableSubmit:J})))}}}]);