(self.webpackChunk_unified_order=self.webpackChunk_unified_order||[]).push([[8716],{58716:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>P});var r=l(11746),n=l(74315),a=l(2411),s=l.n(a),o=l(12783),i=l(6277),c=l(21602),d=l(33553),u=l(23664),p=l(75696),m=l(4409),v=l(48049),f=l(91787),y=l(13432),S=l(13029),I=l(13268),b=l(30230),h=l(36502),g=l(81264),E=l(68635),N=l(54867),Z=l(34859),k=l(61990),D=l(24235),M=l(63135),w=(0,p.makeStyles)((function(e){return(0,p.createStyles)({element:{margin:e.spacing(1),padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1.5),"px"),borderRadius:e.shape.borderRadius},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},btnPrimary:{background:e.palette.primary.main,color:e.palette.primary.contrastText},decisionWrapper:{marginLeft:e.spacing(1),padding:"".concat(e.spacing(3),"px ").concat(e.spacing(1),"px")}})})),L=function(e){var t,l=e.state,r=e.dispatch,n=null!==(t=l.buyer)&&void 0!==t&&t.resellerId?[l.buyer.resellerId]:[];return s().createElement(y.Z,{onSelectReseller:function(e){r({type:"buyer_select",payload:e})},selectedItems:n})},x=function(e){var t=e.state,l=e.dispatch;return(0,a.useEffect)((function(){l({type:"drop_location_select",payload:[t.buyer]})}),[]),s().createElement(h.Z,{state:t,dispatch:l})},C=function(e){var t=e.state,l=e.dispatch;return s().createElement(g.Z,{state:t,dispatch:l})},R=function(e){var t,l,r,n=e.dispatch,a=e.state,o=e.inventoryReseller,i=(0,c.Z)(),d=null==a||null===(t=a.seller)||void 0===t?void 0:t.resellerId;return"parentInventory"==o&&(d=null==i||null===(l=i.info)||void 0===l||null===(r=l.resellerData)||void 0===r?void 0:r.parentResellerId),s().createElement(k.Z,{resellerId:d||null,state:a,dispatch:n})},_=function(e){var t=e.dispatch,l=e.state;return s().createElement(E.Z,{state:l,dispatch:t})};const P=function(e){var t,l=e.state,p=e.dispatch,y=(0,M.useTranslation)().t,h=(0,c.Z)(),g=(0,u.Z)(),E=g.showSuccessMessage,k=g.showErrorMessage,P=(0,a.useState)(!1),q=(0,n.Z)(P,2),z=q[0],B=q[1],H=(0,a.useState)(),F=(0,n.Z)(H,2),O=F[0],T=F[1],W=(0,a.useState)(!1),A=(0,n.Z)(W,2),U=A[0],j=A[1],G=(0,a.useState)(!1),J=(0,n.Z)(G,2),K=J[0],Q=J[1],V=s().useState("ownInventory"),X=(0,n.Z)(V,2),Y=X[0],$=X[1],ee=(0,a.useState)(!1),te=(0,n.Z)(ee,2),le=te[0],re=te[1],ne=(0,a.useState)([{label:y("selectBuyer")},{label:y("dropLocation")},{label:y("inventory")},{label:y("pickUpLocation")},{label:y("selectStock")},{label:y("deliveryOption")},{label:y("paymentInformation")},{label:y("orderDetails")}]),ae=(0,n.Z)(ne,2),se=ae[0],oe=ae[1],ie=w(),ce=(0,v.useHistory)(),de=null===(t=window.config.order)||void 0===t?void 0:t.employeeSnicCategory,ue=(0,N.Z)(null==h?void 0:h.info),pe=function(){return ue===de};function me(){B(!0);var e=(0,b.requestHelper)(l,h,Y);return j(!0),(0,S.ry)(e).then((function(e){0===e.resultCode?(E(e),T({message:e.resultMessage,kind:"success"}),j(!1)):(B(!1),k(e))})).catch((function(e){B(!1),k(e)}))}function ve(e){switch(e){case 0:return null==l.seller;case 1:return 0===l.dropLocation.length;case 2:return pe()?K:0===l.pickupLocation.length;case 3:return pe()?0===l.pickupLocation.length:!(0,D.z3)(l);case 4:return pe()?!(0,D.z3)(l):!l.deliveryOptions.mode;case 5:return!l.deliveryOptions.mode;default:return!1}}(0,a.useEffect)((function(){p({type:"seller_select",payload:{resellerId:null==h?void 0:h.requestedPrincipalId,resellerMSISDN:null==h?void 0:h.targetMSISDN,resellerName:null==h?void 0:h.targetPrincipalName}})}),[h]),(0,a.useEffect)((function(){var e=(0,r.Z)(se);return pe()||(e=e.filter((function(e){return e.label!==y("inventory")}))),oe(e)}),[h]);var fe,ye,Se=(0,b.requestHelper)(l,h,Y);return s().createElement(s().Fragment,null,z&&s().createElement(f.Z,{loading:U,orderMessage:O,handleClose:function(){B(!1),p({type:"reset",payload:null}),ce.push("/home/order/orders")}}),s().createElement(o.SeamlessStepper,{steps:se,components:{Control:function(e){e.goFirst;var t=e.goNext,l=e.goPrev,r=e.disableFirst,n=e.disableLast,a=e.view;return s().createElement(d.Z,null,s().createElement(o.SeamlessButton,{onClick:l,disabled:r,className:(0,i.default)(ie.element),color:"primary",variant:"contained"},y("previous")),s().createElement(o.SeamlessButton,{className:(0,i.default)(ie.element,ie.btnPrimary),onClick:t,disabled:n||ve(a),color:"primary",variant:"contained"},y("next")),n&&s().createElement(o.SeamlessButton,{className:(0,i.default)(ie.element),onClick:me,color:"primary",variant:"contained",disabled:le},y("submit")))}}},s().createElement(L,{dispatch:p,state:l}),s().createElement(x,{dispatch:p,state:l}),pe()&&s().createElement(d.Z,{className:ie.decisionWrapper},s().createElement(Z.Z,{options:[{label:y("ownInventory"),value:"ownInventory"},{label:y("parentInventory"),value:"parentInventory"}],value:Y,onSelect:function(e){Q(!1),$(e);var t,l,r,n,a={resellerId:null==h?void 0:h.requestedPrincipalId,resellerMSISDN:null==h?void 0:h.targetMSISDN,resellerName:null==h?void 0:h.targetPrincipalName};"parentInventory"==e&&(a={resellerId:null==h||null===(t=h.info)||void 0===t||null===(l=t.resellerData)||void 0===l?void 0:l.parentResellerId,resellerMSISDN:"",resellerName:null==h||null===(r=h.info)||void 0===r||null===(n=r.resellerData)||void 0===n?void 0:n.parentResellerName}),p({type:"seller_select",payload:a})}})),s().createElement(C,{dispatch:p,state:l}),s().createElement(R,{dispatch:p,state:l,inventoryReseller:Y}),s().createElement(_,{dispatch:p,state:l}),s().createElement(m.Z,{state:l,dispatch:p}),s().createElement(I.Z,{dataAPI:Se,paymentInfo:!0,state:l,from:(ye=null==l?void 0:l.seller,{resellerId:null==ye?void 0:ye.resellerId,resellerMSISDN:null==ye?void 0:ye.resellerMSISDN,resellerName:null==ye?void 0:ye.resellerName,pickupLocation:null==l?void 0:l.pickupLocation}),to:(fe=null==l?void 0:l.buyer,{resellerId:null==fe?void 0:fe.resellerId,resellerMSISDN:null==fe?void 0:fe.resellerMSISDN,resellerName:null==fe?void 0:fe.resellerName,dropLocation:null==l?void 0:l.dropLocation}),itemList:(0,D.RH)(l),dispatch:p,setDisableSubmit:re})))}}}]);