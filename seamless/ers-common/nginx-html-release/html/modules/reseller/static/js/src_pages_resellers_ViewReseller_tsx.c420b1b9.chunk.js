(self.webpackChunk_unified_reseller=self.webpackChunk_unified_reseller||[]).push([["src_pages_resellers_ViewReseller_tsx"],{63406:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>C});var n=t(51119),s=t(74315),a=t(2411),o=t(67358),l=t(48049),c=t(70773),u=t(29609),i=t(79692),d=t(12420),f=t(53165),p=t(14674),m=t(77790),h=t.n(m),g=t(9692),v=t(23664),w=t(54462),E=t(38670),b=t(91955);function y(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function D(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?y(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var S="",I=(0,i.Z)((function(e){return(0,d.Z)({element:{marginTop:e.spacing(2),marginBottom:e.spacing(2)},uploadInput:{"& #seamless-unified-upload":{border:"2px solid ".concat(e.palette.success.main),borderRadius:"8px"}}})}));const C=function(e){var r,t,i,d,m=e.customFeatureList,y=void 0===m?[]:m,C=(0,l.useParams)().id,P=(0,u.useTranslation)().t,R=(0,v.Z)(),O=R.showErrorMessage,L=R.showSuccessMessage,T=(0,l.useHistory)(),k=a.useState(null),j=(0,s.Z)(k,2),M=j[0],Z=j[1],x=a.useState({reason:"",reasonDocument:""}),A=(0,s.Z)(x,2),U=A[0],_=A[1],q=a.useState(!1),F=(0,s.Z)(q,2),z=F[0],G=F[1],N=a.useState(!1),V=(0,s.Z)(N,2),B=V[0],H=V[1],W=a.useState({}),Y=(0,s.Z)(W,2),J=Y[0],K=Y[1],Q=(0,E.useSelector)((function(e){return e.auth})).user,X=I(),$={reason:"",reasonDocument:""},ee=a.useCallback((function(){var e=new URLSearchParams(window.location.search),r="RESELLERID";e.has("type")&&(r=e.get("type")||"RESELLERID");var t={dealerID:{id:C,type:r},fetchAccountBalanceInformation:!0};G(!0),(0,p.gH)(t).then((function(e){if(G(!1),0===e.resultCode){var r=e.resellerInfo;if(Z(r),e.resellerInfo&&r.resellerData){var t=e.resellerInfo.resellerData;t&&K(t)}else O(P("noDataFoundResellerInfo","Sorry, Unable to find reseller info")),Z(null)}})).catch((function(e){return O(e)})).finally((function(){return G(!1)}))}),[]);a.useEffect((function(){ee()}),[]);var re=a.useCallback((function(e){H(!0),S=e}),[]),te=J.resellerId||C,ne=null!==(r=null===(t=window)||void 0===t||null===(i=t.config)||void 0===i||null===(d=i.resellerAdditionalConfig)||void 0===d?void 0:d.notificationMode)&&void 0!==r?r:"SMS",se=a.useCallback((function(){G(!0);var e,r=Q.requestedPrincipalId?"RESELLERID":"RESELLERMSISDN",t={principalId:{id:Q.requestedPrincipalId?Q.requestedPrincipalId:Q.targetMSISDN,type:r},operationType:S,channel:"PORTAL",clientId:Q.userId,prepareOnly:!1,prepareRequired:!1,referredChainErsReference:"",pendingTimeout:6e5,customParameters:{globalReason:U.reason},password:U.password,targetPrincipalType:r,targetResellers:(0,n.Z)({},"".concat(te),U.reason)};if("DEACTIVATE"===S){if(t.customParameters["".concat(te)]=U.reasonDocument,null===(e=window.config.resellerAdditionalConfig)||void 0===e?void 0:e.isDocumentRequired){if(!U.reason||!U.reasonDocument)return O(P("missingFieldsErrorGeneral"))}else if(!U.reason)return O(P("missingFieldsErrorGeneral"))}else if(!U.reason)return O(P("missingFieldsErrorGeneral"));(0,p.wv)(t).then((function(e){if(0===e.resultCode){var r=e.resultDescription||e.resultMessage||"Status changed successfully";L("".concat(r)),H(!1),ee()}else{var t=Object.values(e.resultDetails);O(t[0]||e)}})).catch((function(e){return O(e)})).finally((function(){G(!1),_($)}))}),[J,U,Q]),ae=a.useCallback((function(e,r){var t={userId:e,resellerId:r};(0,p.uZ)(t).then((function(e){if(0===e.resultCode){var r=e.resultDescription||e.resultMessage||"Password expired successfully";L("".concat(r)),H(!1),ee()}else O((0,b.az)(e,"Unable to expired the reseller password due to some error"))})).catch((function(e){return O(e)})).finally((function(){return G(!1)}))}),[]),oe=a.useCallback((function(e){var r={notificationMode:ne,userId:e},t={};Object.keys(r).forEach((function(e){r["".concat(e)]&&(t["".concat(e)]=r["".concat(e)])})),(0,p.c0)(t).then((function(e){if(0===e.resultCode){var r=e.resultDescription||e.resultMessage||"Password expired successfully";L("".concat(r)),H(!1),ee()}else O((0,b.az)(e,"Unable to reset the reseller password due to some error"))})).catch((function(e){return O(e)})).finally((function(){return G(!1)}))}),[]),le=a.useCallback((function(e,r){(0,p.Gh)(e).then((function(e){if(0===e.resultCode){var r=e.resultDescription||e.resultMessage||P("recordUpdateSuccess","Record updated successfully!");L("".concat(r)),T.push("/home/reseller/resellers/view/".concat(C))}else O((0,b.az)(e,P("recordUpdateError")))})).catch((function(e){return O(e)})).finally((function(){return G(!1)}))}),[]),ce=a.useCallback((function(e,r,t){G(!0),(0,p.hm)(e,r.toLowerCase(),t.toLowerCase()).then((function(e){if(0===e.resultCode){var r=e.resultDescription||e.resultMessage||P("recordUpdateSuccess","Record updated successfully!");L("".concat(r)),T.push("/home/reseller/resellers/view/".concat(C))}else O((0,b.az)(e,P("recordUpdateError")))})).catch((function(e){return O((0,b.az)(e,P("recordUpdateError")))})).finally((function(){return G(!1)}))}),[]);return a.createElement(c.SeamlessContainer,{title:P("viewResellersPageTitle",{element:C}),description:P("viewResellersPageDescription")},a.createElement(f.Z,{"data-testid":"view-reseller-info",data:J,id:C,loading:z,handleExpirePassword:ae,handleResetPassword:oe,handleResetWrongPasswordAttempts:le,resellerInfo:M,handleStatus:re,handleLifelineStatus:ce,customFeatureList:y}),z?a.createElement(o.Z,null):null,a.createElement(w.default,{open:B,onClose:function(){H(!1),_($),G(!1)},onOk:se,dialogTitle:P("areYouSure"),dialogDescription:P("areYouSureOperation",{statusType:S})},a.createElement(c.SeamlessInput,{fullWidth:!0,required:!0,multiline:!0,rows:4,rowsMax:4,error:!U.reason,className:X.element,value:U.reason,onChange:function(e){return _(D(D({},U),{reason:e.target.value}))},label:P("enterReason",{reason:S,id:C}),helperText:P("reasonPlaceholder")}),"DEACTIVATE"===S&&a.createElement("div",{className:U.reasonDocument?X.uploadInput:""},a.createElement(h(),{name:"global-reason-doc",value:U.reasonDocument,label:P("reasonDocumentPlaceholder"),onChange:function(e){var r="".concat((0,g.getSrc)(e.target.value));_(D(D({},U),{reasonDocument:r}))},resourceType:"agent"}),U.reasonDocument&&P("uploadSuccessful"))))}}}]);