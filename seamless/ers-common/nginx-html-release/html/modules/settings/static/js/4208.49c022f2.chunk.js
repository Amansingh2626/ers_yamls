(self.webpackChunk_unified_settings=self.webpackChunk_unified_settings||[]).push([[4208],{4208:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ne});var l=n(2411),a=n.n(l),r=n(33553),i=n(70773),o=n(63135),c=n(18896),s=n(48049),u=n(7560),m=n(55238),d=n(51119),p=n(74315),f=n(97848),v=n(13248),g=n(41744),E=n.n(g);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const h=function(e,t){var n=e.children,a=((0,o.useTranslation)().t,(0,v.useSnackbar)().enqueueSnackbar),r=l.useState(!1),i=(0,p.Z)(r,2),c=i[0],s=i[1],u=l.useState(0),m=(0,p.Z)(u,2),d=m[0],E=m[1],Z=l.useState([]),h=(0,p.Z)(Z,2),b=h[0],S=h[1],C=l.useState(),w=(0,p.Z)(C,2),k=w[0],O=w[1],P=l.useState({}),N=(0,p.Z)(P,2),j=N[0],D=N[1],x=(0,g.useServerTable)({page:0,perPage:20,order:"desc",orderBy:"startTime",filter:{}}),F=l.useCallback((function(){s(!0),(0,f.VV)({filtration:j,pagination:{pageNumber:x.page,pageSize:x.perPage}}).then((function(e){S(e.policyList.map((function(e){return{id:e.policy.id,name:e.policy.name,description:e.policy.description,availableFrom:e.policy.availableFrom,availableUntil:e.policy.availableUntil}}))),E(e.count),O(e)})).catch((function(e){return a(e.message,{variant:"error"})})).finally((function(){return s(!1)}))}),[x.page,x.perPage,j]);return l.useEffect((function(){F()}),[F]),l.createElement(l.Fragment,null,n(y(y({loading:c,accessList:b,totalCount:d,setFilter:D,filter:j},x),{},{accessListResponse:k})))};var b,S,C,w,k=n(11746),O=n(79692),P=n(12420),N=n(77277),j=n(8629),D=n(79249),x=n(38592),F=n(49429),M=n(38724),B=n(55999),z=n(7089),T=n(4614),H=n(42494),L=n(56939),W=n(29611),_=n(80030),R=n(60552),U=n(89058),V=n(27667),A=n(60905),I=n(90436),q=n(73659),Y=n(6277);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J=null!==(b=null===(S=window)||void 0===S||null===(C=S.config)||void 0===C||null===(w=C.settings)||void 0===w?void 0:w.hideDateInPolicy)&&void 0!==b&&b,K=(0,O.Z)((function(e){var t,n;return(0,P.Z)({dialogHeader:{fontSize:18,fontWeight:"bold",align:"left",backgroundColor:e.palette.primary.main,color:null==e||null===(t=e.palette)||void 0===t||null===(n=t.common)||void 0===n?void 0:n.white},dialogContent:{fontSize:14},fieldHeading:{fontWeight:"bold",textTransform:"capitalize",fontSize:14},fieldContent:{fontSize:13},row:{marginBottom:e.spacing(1)},top:{marginRight:e.spacing(1),marginTop:e.spacing(.5)},content:{textAlign:"left",maxHeight:400,minWidth:550,overflowY:"scroll"},blurBackDrop:{backdropFilter:"blur(2px)",backgroundColor:"rgba(0, 0, 0, 0.2)"},accordian:{backgroundColor:"rgba(128, 128, 128)"},accordianTitle:{color:"white"}})}));function Q(e){K();var t=e.item,n=e.applyValue;return l.createElement("div",null,l.createElement(H.Z,{fullWidth:!0},l.createElement(L.Z,{htmlFor:"age-native-simple"},"Enter Value"),l.createElement(W.Z,{placeholder:"value",fullWidth:!0,value:t.value||"",onChange:function(e){n(G(G({},t),{},{value:e.target.value}))}})))}const X=function(e){var t,n,a,r,c,u,m,g,Z,y,h=e.loading,b=e.accessList,S=(e.accessListResponse,e.page),C=e.perPage,w=e.filter,O=e.handleDelete,P=e.onPageChange,H=e.onPageSizeChange,L=e.setFilter,W=e.totalCount,$=K(),X=(0,v.useSnackbar)().enqueueSnackbar,ee=(0,o.useTranslation)().t,te=(0,s.useHistory)(),ne=l.useState(!1),le=(0,p.Z)(ne,2),ae=le[0],re=le[1],ie=l.useState(!1),oe=(0,p.Z)(ie,2),ce=oe[0],se=oe[1],ue=l.useState({}),me=(0,p.Z)(ue,2),de=me[0],pe=me[1],fe=l.useState({}),ve=(0,p.Z)(fe,2),ge=ve[0],Ee=ve[1],Ze=l.useState(!1),ye=(0,p.Z)(Ze,2),he=ye[0],be=ye[1],Se=l.useState(""),Ce=(0,p.Z)(Se,2),we=(Ce[0],Ce[1]),ke=l.useState({}),Oe=(0,p.Z)(ke,2),Pe=Oe[0],Ne=Oe[1],je=l.useState(null),De=(0,p.Z)(je,2),xe=De[0],Fe=De[1],Me=l.useState(""),Be=(0,p.Z)(Me,2),ze=Be[0],Te=Be[1],He=l.useState(!1),Le=(0,p.Z)(He,2),We=Le[0],_e=Le[1],Re=l.useState({}),Ue=(0,p.Z)(Re,2),Ve=Ue[0],Ae=Ue[1],Ie=l.useState(""),qe=(0,p.Z)(Ie,2),Ye=qe[0],$e=qe[1],Ge=l.useState({policyName:"",description:"",role_type:""}),Je=(0,p.Z)(Ge,2),Ke=Je[0],Qe=Je[1],Xe=null!==(t=null===(n=window)||void 0===n||null===(a=n.config)||void 0===a||null===(r=a.settings)||void 0===r?void 0:r.hideClonePolicy)&&void 0!==t&&t,et=l.useRef(!0);Z=function(){et.current?et.current=!1:L(G({},Ke))},y=[Ke],(0,l.useEffect)((function(){var e=setTimeout((function(){return Z()}),1300);return function(){return clearTimeout(e)}}),[].concat((0,k.Z)(y||[]),[1300]));var tt=[{label:"Contains",value:"contains",getApplyFilterFn:function(e){return e.columnField&&e.value&&e.operatorValue?function(t){return t.value==e.value}:null},InputComponent:Q}],nt=[{field:"name",headerName:ee("policyName","Policy Name"),width:200,filterable:!0,filterOperators:tt},{field:"description",headerName:ee("description","Description"),width:200,filterable:!0,filterOperators:tt},{field:"availableFrom",headerName:ee("availableFrom"),width:200,filterable:!1,hide:J},{field:"availableUntil",headerName:ee("availableUntil"),width:200,filterable:!1,hide:J},{field:"actions",headerName:ee("actions"),sortable:!1,filterable:!1,width:200,renderCell:function(e){var t;return l.createElement("div",null,l.createElement(x.Z,{size:"small",color:"primary",variant:"text"},l.createElement(_.ZP,{title:"Edit"},l.createElement(N.Z,{component:s.Link,to:"/home/settings/access-management/policy/".concat(null==e||null===(t=e.row)||void 0===t?void 0:t.id)},l.createElement(q.Z,{fontSize:"small"}))),l.createElement(_.ZP,{title:"View"},l.createElement(N.Z,{onClick:function(){var t;t=null==e?void 0:e.row,be(!0),se(!0),(0,f.vm)(null==t?void 0:t.id).then((function(e){Ee(e),we(null==e?void 0:e.channels.join()),function(e){for(var t={},n=(0,k.Z)(new Set(e.map((function(e){return e.module})))),l=function(l){var a=e.filter((function(e){return e.module==n[l]&&(e.description?e.description:null==e?void 0:e.module_feature)})).map((function(e){return"".concat(e.description?e.description:null==e?void 0:e.module_feature," - ").concat(e.channels)}));t[n[l]]=a},a=0;a<n.length;a++)l(a);Ne(t)}(null==e?void 0:e.module_features)})).catch((function(e){X(e.resultMessage,{variant:"error"}),te.push("/home/settings/access-management/list")})).finally((function(){return be(!1)}))}},l.createElement(R.Z,{fontSize:"small"}))),!Xe&&l.createElement(_.ZP,{title:"Clone"},l.createElement(N.Z,{onClick:function(){var t,n;n=null==e||null===(t=e.row)||void 0===t?void 0:t.id,(0,f.HZ)(n).then((function(e){Ae(e),_e(!0)})).catch((function(e){X(e.resultMessage,{variant:"error"}),te.push("/home/settings/access-management/policy/list")}))}},l.createElement(V.Z,{fontSize:"small"}))),l.createElement(_.ZP,{title:"Delete"},l.createElement(N.Z,{onClick:function(){pe(null==e?void 0:e.row),re(!0)}},l.createElement(U.Z,{fontSize:"small"})))))},flex:1}];return l.createElement(l.Fragment,null,l.createElement(E(),{onPageSizeChange:function(e){H(e.pageSize)},onPageChange:function(e){P(e.page)},pagination:!0,paginationMode:"server",page:S,pageSize:C,rowCount:W,rows:b,loading:h,columns:nt,getRowId:function(e){var t;return null==e||null===(t=e.policy)||void 0===t?void 0:t.id},columnBuffer:3,sortingMode:"server",filterMode:"server",onFilterModelChange:function(e){var t=e.filterModel.items[0].value,n=e.filterModel.items[0].columnField;Qe(G(G({},w),{},(0,d.Z)({},n,t)))}}),l.createElement(j.Z,{open:ae,keepMounted:!0,onClose:function(){return re(!1)},BackdropProps:{classes:{root:$.blurBackDrop}}},l.createElement(D.Z,{className:$.dialogHeader,disableTypography:!0},"Are you sure?"),l.createElement(M.Z,null,l.createElement(B.Z,{className:$.dialogContent},"Are you sure you want to delete the policy with name ".concat(de.name,"?"))),l.createElement(F.Z,null,l.createElement(i.SeamlessButton,{variant:"outlined",color:"primary",onClick:function(){return re(!1)}},"Cancel"),l.createElement(i.SeamlessButton,{variant:"contained",color:"primary",onClick:function(){O(null==de?void 0:de.id),re(!1)}},"Delete"))),l.createElement(j.Z,{open:ce,keepMounted:!0,maxWidth:"md",fullWidth:!0,onClose:function(){se(!1),Ee({})},BackdropProps:{classes:{root:$.blurBackDrop}}},l.createElement(D.Z,{className:$.dialogHeader,color:"primary",disableTypography:!0},he?"Loading Policy Details...":null==ge||null===(c=ge.policy)||void 0===c?void 0:c.name),l.createElement(M.Z,null,he?l.createElement(A.Z,{container:!0},l.createElement(A.Z,null,l.createElement(T.Z,null))):l.createElement(l.Fragment,null,l.createElement(A.Z,{container:!0,spacing:2,className:$.row},l.createElement(A.Z,{item:!0,xs:3},l.createElement(I.Z,{className:$.fieldHeading},"Description")),l.createElement(A.Z,{item:!0,xs:9},l.createElement(I.Z,{className:$.fieldContent},null==ge||null===(u=ge.policy)||void 0===u?void 0:u.description))),l.createElement(A.Z,{container:!0,spacing:2,className:$.row},l.createElement(A.Z,{item:!0,xs:3},l.createElement(I.Z,{className:$.fieldHeading},"Start Date")),l.createElement(A.Z,{item:!0,xs:9},l.createElement(I.Z,{className:$.fieldContent},null==ge||null===(m=ge.policy)||void 0===m?void 0:m.availableFrom))),l.createElement(A.Z,{container:!0,spacing:2,className:$.row},l.createElement(A.Z,{item:!0,xs:3},l.createElement(I.Z,{className:$.fieldHeading},"End Date")),l.createElement(A.Z,{item:!0,xs:9},l.createElement(I.Z,{className:$.fieldContent},null==ge||null===(g=ge.policy)||void 0===g?void 0:g.availableUntil))),l.createElement(A.Z,{container:!0,spacing:2,className:$.row},l.createElement(A.Z,{item:!0,xs:3},l.createElement(I.Z,{className:(0,Y.default)($.fieldHeading,$.top)},"Modules")),l.createElement(A.Z,{item:!0,xs:9},Object.keys(Pe).map((function(e){return l.createElement(z.Z,{label:e,key:e,variant:ze===e?"default":"outlined",color:"primary",className:$.top,onClick:function(){Te(e),Fe(Pe[e])}})})))),l.createElement(A.Z,{container:!0,spacing:2,className:(0,Y.default)($.row)},l.createElement(A.Z,{item:!0,xs:3},l.createElement(I.Z,{className:(0,Y.default)($.top,$.fieldHeading)},"Features")),l.createElement(A.Z,{item:!0,xs:9},null===xe?l.createElement(I.Z,{className:(0,Y.default)($.top,$.fieldContent)},"Select any Module"):xe.length<=0?l.createElement(I.Z,{className:(0,Y.default)($.top,$.fieldContent)},"No Features for Selected module"):xe.map((function(e,t){return l.createElement(z.Z,{label:e,key:t,variant:"outlined",className:$.top})})))))),l.createElement(F.Z,null,l.createElement(i.SeamlessButton,{variant:"outlined",color:"primary",onClick:function(){Te(""),Fe(null),se(!1)}},"Close"))),l.createElement(j.Z,{open:We,keepMounted:!0,maxWidth:"sm",fullWidth:!0,onClose:function(){_e(!1),Ae({})},BackdropProps:{classes:{root:$.blurBackDrop}}},l.createElement(D.Z,{className:$.dialogHeader,color:"primary",disableTypography:!0},ee("clonePolicy")),l.createElement(M.Z,null,l.createElement(A.Z,{item:!0,xs:12,sm:9,md:8,lg:8},l.createElement(i.SeamlessInput,{required:!0,fullWidth:!0,value:Ye,onChange:function(e){var t;return $e(null==e||null===(t=e.target)||void 0===t?void 0:t.value)},label:ee("policyName")}))),l.createElement(F.Z,null,l.createElement(F.Z,null,l.createElement(i.SeamlessButton,{variant:"outlined",color:"primary",onClick:function(){_e(!1),Ae({}),$e("")}},ee("cancel")),l.createElement(i.SeamlessButton,{variant:"contained",color:"primary",onClick:function(){var e,t,n,l;l={name:Ye,description:null==Ve||null===(e=Ve.policy)||void 0===e?void 0:e.description,availableFrom:null==Ve||null===(t=Ve.policy)||void 0===t?void 0:t.availableFrom,availableUntil:null==Ve||null===(n=Ve.policy)||void 0===n?void 0:n.availableUntil,feature:null==Ve?void 0:Ve.module_features},(0,f.$Z)(l).then((function(e){X(null==e?void 0:e.resultMessage,{variant:"success"}),te.push("/home/settings/access-management")})).catch((function(e){X(null==e?void 0:e.resultMessage,{variant:"error"})})).finally((function(){Ae({}),$e(""),_e(!1)}))},disabled:""===Ye},ee("clone"))))))},ee=function(e){var t=e.children,n=(0,o.useTranslation)().t,a=(0,v.useSnackbar)().enqueueSnackbar,r=l.useState(!1),i=(0,p.Z)(r,2),c=i[0],u=i[1],m=(0,s.useHistory)();return l.createElement(l.Fragment,null,t({loading:c,handleDelete:function(e){u(!0),(0,f.O_)(e).then((function(e){0===(null==e?void 0:e.resultCode)?(a("Policy deleted successfully",{variant:"success"}),m.push("/home/settings/access-management/list")):a("".concat(null==e?void 0:e.resultMessage),{variant:"error"})})).catch((function(e){return a(n("unknownError"),{variant:"error"})})).finally((function(){return u(!1)}))}}))},te=function(){return a().createElement(ee,null,(function(e){var t=e.loading,n=e.handleDelete;return a().createElement(h,{refresh:t},(function(e){var t=e.accessListResponse,l=e.accessList,r=e.loading,i=e.totalCount,o=(0,m.Z)(e,["accessListResponse","accessList","loading","totalCount"]);return a().createElement("div",{style:{height:500,width:"100%"}},a().createElement(X,(0,u.Z)({},o,{loading:r,handleDelete:n,accessList:l,totalCount:i,accessListResponse:t})))}))}))},ne=function(){var e=(0,o.useTranslation)().t;return l.createElement(i.SeamlessContainer,{title:e("accessManagement","Access Management"),description:e("accessManagementDescription","")},l.createElement(r.Z,null,l.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},l.createElement(i.SeamlessButton,{component:s.Link,to:"/home/settings/access-management/policy/create",variant:"contained",color:"primary",startIcon:l.createElement(c.Z,null)},e("createNewPolicy","Create new policy")))),l.createElement("div",{style:{height:"500px",marginTop:"10px"}},l.createElement(te,null)))}}}]);