(self.webpackChunk_unified_settings=self.webpackChunk_unified_settings||[]).push([[8621],{88621:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>z});var a=n(2411),l=n(33553),i=n(70773),r=n(63135),o=n(56470),c=n(11746),s=n(74315),u=n(77162),m=n.n(u),d=n(27266),p=n(77277),v=n(61564),f=n(26977),g=n(19258),h=n(42494),Z=n(84899),E=n(60905),S=n(90436),y=n(79692),b=n(12420),x=n(8629),N=n(79249),w=n(38724),M=n(49429),k=(0,y.Z)((function(e){return(0,b.Z)({root:{borderRadius:"50%"},dialogTitle:{marginTop:"10px",fontWeight:"bold",textAlign:"center"},dialogWrapper:{"& .MuiDialog-container":{width:"100%"},"& .MuiDialogContent-root":{marginTop:e.spacing(2),marginBottom:e.spacing(3)}},heading:{fontWeight:700},loopHeading:{fontWeight:700,marginBottom:e.spacing(1.3)},policyName:{fontWeight:700,marginLeft:e.spacing(1)},rowSpacing:{marginBottom:e.spacing(1.5)},rowSpacingModule:{marginBottom:e.spacing(2)},desc:{marginBottom:e.spacing(2.5)},moduleText:{fontSize:13},cancelAction:{textAlign:"right"},updateAction:{textAlign:"left"},blurBackDrop:{backdropFilter:"blur(2px)",backgroundColor:"rgba(0, 0, 0, 0.2)"}})}));const T=function(e){var t,n,l,i=e.data,o=e.open,c=e.onSubmit,s=e.cancel,u=e.disabled,m=k();return(0,r.useTranslation)().t,a.createElement(x.Z,{open:o,fullWidth:!0,disableBackdropClick:!0,className:m.root,BackdropProps:{classes:{root:m.blurBackDrop}}},a.createElement(N.Z,{id:"alert-dialog-title",color:"primary"},a.createElement(S.Z,{color:"primary",variant:"h6",className:m.dialogTitle},"Policy Update")),a.createElement(w.Z,null,a.createElement(E.Z,{container:!0,className:m.rowSpacing},a.createElement(E.Z,{item:!0},a.createElement(S.Z,{color:"primary",className:m.heading},"Policy Name")),a.createElement(E.Z,{item:!0},a.createElement(S.Z,{className:m.policyName},null==i?void 0:i.policyName))),a.createElement(E.Z,{container:!0,className:m.desc},a.createElement(E.Z,{item:!0},a.createElement(S.Z,{color:"primary",className:m.heading},"Description")),a.createElement(E.Z,{item:!0},a.createElement(S.Z,{className:m.policyName},null==i?void 0:i.description))),a.createElement(E.Z,{container:!0,spacing:4},a.createElement(E.Z,{item:!0,xs:12,sm:6,md:6},a.createElement(S.Z,{className:m.loopHeading},"Accessible modules:"),null===(t=(null==i?void 0:i.left)||[])||void 0===t?void 0:t.map((function(e,t){return a.createElement(S.Z,{key:t,className:m.moduleText},e)}))),a.createElement(E.Z,{item:!0,xs:12,sm:6,md:6,className:m.rowSpacing},a.createElement(S.Z,{className:m.loopHeading},"Accessible sub options:"),null===(n=(null==i?void 0:i.leftFeature)||[])||void 0===n?void 0:n.map((function(e,t){return a.createElement(S.Z,{key:t,className:m.moduleText},"".concat(null==e?void 0:e.module," | ").concat(null!=e&&e.description?null==e?void 0:e.description:null==e?void 0:e.module_feature," - ").concat(e.channels," ").concat((null==e?void 0:e.http_method)&&"|"+(null==e?void 0:e.http_method)))})))),a.createElement(E.Z,{container:!0,spacing:4,className:m.rowSpacingModule},a.createElement(E.Z,{item:!0,xs:12,sm:12,md:12},a.createElement(S.Z,{className:m.loopHeading},"Channels"),null===(l=(null==i?void 0:i.channelSelected)||[])||void 0===l?void 0:l.map((function(e,t){return a.createElement(S.Z,{key:t,className:m.moduleText},e)}))))),a.createElement(M.Z,null,a.createElement(E.Z,{container:!0,spacing:4,style:{margin:"10px"}},a.createElement(E.Z,{item:!0,xs:12,sm:6,md:6,className:m.cancelAction},a.createElement(p.Z,{color:"primary",variant:"outlined",onClick:s},"Cancel")),a.createElement(E.Z,{item:!0,xs:12,sm:6,md:6,className:m.updateAction},a.createElement(p.Z,{color:"primary",variant:"contained",onClick:c,disabled:u},"Update")))))};var P,C,D,_,A=n(6277),B=n(98069),H=n(97848),L=n(48049),W=n(13248),F=n(84278),I=n(31807),O=null!==(P=null===(C=window)||void 0===C||null===(D=C.config)||void 0===D||null===(_=D.settings)||void 0===_?void 0:_.hideDateInPolicy)&&void 0!==P&&P,R=(0,y.Z)((function(e){return(0,b.Z)({datePicker:{"& .MuiInputBase-root":{paddingLeft:e.spacing(1),height:"40px",backgroundColor:"rgb(245, 245, 245)!important",borderRadius:"5px"}},pickerPopover:{"& h3.MuiPickersToolbarText-toolbarTxt.MuiTypography-h3":{fontSize:"2.8rem"}},formStyle:{"& .MuiFormControl-marginNormal":{marginTop:e.spacing(.5)}},rowSpacing:{marginBottom:e.spacing(.5)},element:{maxWidth:"100%",marginRight:e.spacing(1),marginBottom:e.spacing(1)},description:{marginRight:e.spacing(1)},marginTop5:{marginTop:"10px",fontWeight:700,"& button":{marginRight:"10px",marginTop:"15px"}},resellerSelect:{"& .MuiSelect-select":{borderRadius:"5px",marginTop:3}}})}));const U=function(e){e.data;var t=e.loading,n=e.module,u=e.features,y=e.updateData,b=e.isUpdate,x=R(),N=(0,L.useHistory)(),w=(0,r.useTranslation)().t,M=(0,W.useSnackbar)().enqueueSnackbar,k=a.useState(!1),P=(0,s.Z)(k,2),C=P[0],D=P[1],_=a.useState(!1),U=(0,s.Z)(_,2),q=U[0],z=U[1],K=a.useState(""),X=(0,s.Z)(K,2),$=X[0],j=X[1],G=a.useState(""),J=(0,s.Z)(G,2),Q=J[0],V=J[1],Y=a.useState(""),ee=(0,s.Z)(Y,2),te=ee[0],ne=ee[1],ae=a.useState(""),le=(0,s.Z)(ae,2),ie=le[0],re=le[1],oe=a.useState([]),ce=(0,s.Z)(oe,2),se=ce[0],ue=ce[1],me=a.useState([]),de=(0,s.Z)(me,2),pe=de[0],ve=de[1],fe=a.useState([]),ge=(0,s.Z)(fe,2),he=ge[0],Ze=ge[1],Ee=a.useState([]),Se=(0,s.Z)(Ee,2),ye=Se[0],be=Se[1],xe=a.useState([]),Ne=(0,s.Z)(xe,2),we=Ne[0],Me=Ne[1];a.useEffect((function(){ve(n)}),[n]),a.useEffect((function(){1===he.length&&he.indexOf("APP")>-1?(0,H.N$)("app").then((function(e){var t,n=null==e||null===(t=e.appFeatureList)||void 0===t?void 0:t.map((function(e){return null==e?void 0:e.featureCode}));Me(n),be([]),ve([])})).catch((function(e){M(e.resultMessage,{variant:"error"}),N.push("/home/settings/access-management/list")})):(ve(n),Me([]),ue([]),be([]))}),[he]),a.useEffect((function(){u&&ke()}),[se]);var ke=function(){var e,t,n=(null===(e=(u||[]).filter((function(e){return se.includes(e.module)})))||void 0===e||null===(t=e.map((function(e){return e.featureX})))||void 0===t?void 0:t.flat())||[];Me(null==n?void 0:n.map((function(e){return e})));var a=n.filter((function(e){return ye.some((function(t){return(null==t?void 0:t.module)===(null==e?void 0:e.module)&&(null==t?void 0:t.module_feature)===(null==e?void 0:e.module_feature)&&(null==t?void 0:t.description)===(null==e?void 0:e.description)&&(null==t?void 0:t.channels)===(null==e?void 0:e.channels)&&(null==t?void 0:t.http_method)===(null==e?void 0:e.http_method)}))}));be(a)};a.useEffect((function(){var e,t,n,a;if(b){j(null==y?void 0:y.policy.name),re(null==y?void 0:y.policy.description),Ze((null==y?void 0:y.channels)||[]),V(null==y||null===(e=y.policy)||void 0===e?void 0:e.availableFrom),ne(null==y||null===(t=y.policy)||void 0===t?void 0:t.availableUntil);var l=null==y||null===(n=y.module_features)||void 0===n?void 0:n.map((function(e){return e.module})),i=null==y||null===(a=y.module_features)||void 0===a?void 0:a.map((function(e){return e}));ue((0,c.Z)(new Set(l))),be((0,c.Z)(new Set(i)))}}),[y,n,u]);var Te=function(e){var t;return null!=e&&e.name?null!=e&&e.description?!(null==e||null===(t=e.feature)||void 0===t||!t.length)||(M(w("Please select Modules accessible and Sub options accessible."),{variant:"error"}),!1):(M(w("Please enter Description."),{variant:"error"}),!1):(M(w("Please enter Policy Nameâ€‰."),{variant:"error"}),!1)},Pe=function(){var e=(0,o.Z)(m().mark((function e(){var t,n;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null==ye?void 0:ye.map((function(e){return{module:null==e?void 0:e.module,module_feature:null==e?void 0:e.module_feature,description:null==e?void 0:e.description,channels:null==e?void 0:e.channels,http_method:null==e?void 0:e.http_method}})),n={name:$,description:ie,availableFrom:(0,F.Z)((0,I.Z)(new Date(O?"2000-01-01T00:00:00":Q).toISOString()),"yyyy-MM-dd HH:mm:ss"),availableUntil:(0,F.Z)((0,I.Z)(new Date(O?"2090-01-01T12:59:59":te).toISOString()),"yyyy-MM-dd HH:mm:ss"),feature:t},Te(n)){e.next=6;break}return D(!1),e.abrupt("return");case 6:D(!0),(0,H.$Z)(n).then((function(e){0===e.resultCode?(M(null==e?void 0:e.resultMessage,{variant:"success"}),N.push("/home/settings/access-management")):M(null==e?void 0:e.resultMessage,{variant:"error"})})).catch((function(e){M(null==e?void 0:e.resultMessage,{variant:"error"})})).finally((function(){D(!1)}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ce=function(){var e=(0,o.Z)(m().mark((function e(){var t,n,a;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D(!0),n=null==ye?void 0:ye.map((function(e){return{module:null==e?void 0:e.module,module_feature:null==e?void 0:e.module_feature,description:null==e?void 0:e.description,channels:null==e?void 0:e.channels,http_method:null==e?void 0:e.http_method}})),a={policyId:null==y||null===(t=y.policy)||void 0===t?void 0:t.id,name:$,description:ie,feature:n,availableFrom:(0,F.Z)((0,I.Z)(new Date(O?"2000-01-01T00:00:00":Q).toISOString()),"yyyy-MM-dd HH:mm:ss"),availableUntil:(0,F.Z)((0,I.Z)(new Date(O?"2090-01-01T12:59:59":te).toISOString()),"yyyy-MM-dd HH:mm:ss")},Te(a)){e.next=7;break}return D(!1),e.abrupt("return");case 7:return e.next=9,(0,H.i5)(a).then((function(e){0===e.resultCode?(M(null==e?void 0:e.resultMessage,{variant:"success"}),N.push("/home/settings/access-management")):M(null==e?void 0:e.resultMessage,{variant:"error"}),z(!1)})).catch((function(e){M(null==e?void 0:e.resultMessage,{variant:"error"})})).finally((function(){D(!1)}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t?a.createElement(l.Z,{width:"100%"},a.createElement(l.Z,{m:1},a.createElement(B.Z,{animation:"wave",variant:"text",width:200,height:45})),a.createElement(l.Z,{m:1},a.createElement(B.Z,{variant:"text",animation:"wave",width:"90%",height:45})),a.createElement(l.Z,{m:1},a.createElement(B.Z,{variant:"text",animation:"wave",width:"90%",height:45})),a.createElement(l.Z,{m:1},a.createElement(B.Z,{variant:"text",animation:"wave",width:"30%",height:45})),a.createElement(E.Z,{container:!0},a.createElement(E.Z,{item:!0,xs:4},a.createElement(l.Z,{m:1},a.createElement(B.Z,{variant:"rect",width:210,height:230}))),a.createElement(E.Z,{item:!0,xs:4},a.createElement(l.Z,{m:1},a.createElement(B.Z,{variant:"rect",width:210,height:230}))))):a.createElement(a.Fragment,null,a.createElement(E.Z,{container:!0,spacing:3,className:x.rowSpacing},a.createElement(E.Z,{item:!0,xs:12},a.createElement(S.Z,{variant:"h6",color:"primary",className:x.marginTop5},"Basic Information"))),a.createElement(E.Z,{container:!0},a.createElement(E.Z,{container:!0,spacing:3,className:x.rowSpacing},a.createElement(E.Z,{item:!0,xs:12,sm:3,md:4,className:x.resellerSelect},a.createElement(i.SeamlessInput,{required:!0,fullWidth:!0,value:$,onChange:function(e){var t;return j(null==e||null===(t=e.target)||void 0===t?void 0:t.value)},label:w("Policy name"),className:(0,A.default)(x.element)}))),a.createElement(E.Z,{container:!0,spacing:3,className:x.rowSpacing},a.createElement(E.Z,{item:!0,xs:12,sm:6,md:4},a.createElement(i.SeamlessInput,{required:!0,fullWidth:!0,multiline:!0,name:"description",onChange:function(e){var t;return re(null==e||null===(t=e.target)||void 0===t?void 0:t.value)},label:w("Description"),value:ie,className:(0,A.default)(x.description)})))),O?null:a.createElement(E.Z,{container:!0,spacing:3,className:x.rowSpacing},a.createElement(E.Z,{item:!0,xs:12,sm:6,md:3,justify:"space-around"},a.createElement(h.Z,{variant:"filled",className:x.formStyle,fullWidth:!0},a.createElement(Z.Z,null,w("startDate")),a.createElement(v.M,{utils:g.Z},a.createElement(f.B,{className:(0,A.default)(x.datePicker),fullWidth:!0,autoOk:!0,variant:"inline",format:"yyyy-MM-dd HH:mm",margin:"normal",name:"fromDate",value:Q||null,onChange:function(e){V(null==e?void 0:e.toISOString())},KeyboardButtonProps:{"aria-label":"change date"},PopoverProps:{className:x.pickerPopover},disablePast:!b,maxDate:te})))),a.createElement(E.Z,{item:!0,xs:12,sm:6,md:3},a.createElement(v.M,{utils:g.Z},a.createElement(h.Z,{variant:"filled",className:x.formStyle,fullWidth:!0},a.createElement(Z.Z,null,w("endDate")),a.createElement(f.B,{className:(0,A.default)(x.datePicker),fullWidth:!0,autoOk:!0,variant:"inline",format:"yyyy-MM-dd HH:mm",margin:"normal",name:"toDate",value:te||null,onChange:function(e){ne(null==e?void 0:e.toISOString())},disablePast:!b,KeyboardButtonProps:{"aria-label":"change date"},PopoverProps:{className:x.pickerPopover},minDate:Q}))))),a.createElement(E.Z,{container:!0,spacing:3,className:x.rowSpacing},a.createElement(E.Z,{item:!0,xs:12},a.createElement(S.Z,{variant:"h6",color:"primary",className:x.marginTop5},"Modules"))),a.createElement(E.Z,{container:!0,spacing:3,className:x.rowSpacing},a.createElement(E.Z,{item:!0,xs:6},a.createElement(d.Z,{left:se,right:pe,setLeft:ue,setRight:ve,rightTitle:"All modules",placeholder:"Search module",leftTitle:"Modules accessible",allLabelLeft:"Select-All-Modules-Accessible",allLabelRight:"Select-All-Modules"})),a.createElement(E.Z,{item:!0,xs:6},a.createElement(d.Z,{left:ye,right:we,setLeft:be,setRight:Me,rightTitle:"All sub options",placeholder:"Search keyword",leftTitle:"Sub options accessible",allLabelLeft:"Select-All-Sub-Options-Accessible",allLabelRight:"Select-All-Sub-Options"}))),a.createElement("div",{className:x.marginTop5},a.createElement(p.Z,{color:"primary",variant:"contained",disabled:C,onClick:function(){b?z(!0):Pe()}},b?w("preview","Preview"):w("save","Save")),a.createElement(p.Z,{color:"secondary",variant:"contained",onClick:function(){N.push("/home/settings/access-management/list")}},w("cancel","Cancel"))),a.createElement(T,{disabled:C,onSubmit:Ce,cancel:function(){return z(!1)},open:q,data:{policyName:$,description:ie,left:se,leftFeature:ye,channelSelected:he}}))};(0,y.Z)((function(e){return(0,b.Z)({element:{marginRight:e.spacing(1),marginBottom:e.spacing(1),marginLeft:e.spacing(.5)},rowSpacing:{marginBottom:e.spacing(.5)}})}));const q=function(e){var t=e.children,n=(0,W.useSnackbar)().enqueueSnackbar,l=(0,L.useHistory)(),i=(0,L.useParams)().id,r=a.useState(!1),c=(0,s.Z)(r,2),u=c[0],d=c[1],p=a.useState(!1),v=(0,s.Z)(p,2),f=v[0],g=v[1],h=a.useState({}),Z=(0,s.Z)(h,2),E=Z[0],S=(Z[1],a.useState()),y=(0,s.Z)(S,2),b=y[0],x=y[1],N=a.useState([]),w=(0,s.Z)(N,2),M=w[0],k=w[1],T=a.useState(),P=(0,s.Z)(T,2),C=P[0],D=P[1],_=function(e,t){var n=[];t.forEach((function(t){var a=[],l=[];e.filter((function(e){return t===(null==e?void 0:e.module)})).forEach((function(e){return null==e?void 0:e.listOfChannels.forEach((function(t){a.push("".concat(null==e?void 0:e.module," | ").concat(null!=e&&e.description?null==e?void 0:e.description:null==e?void 0:e.moduleFeature," - ").concat(t," ").concat((null==e?void 0:e.httpMethod)&&"|"+(null==e?void 0:e.httpMethod))),l.push({module:null==e?void 0:e.module,module_feature:null==e?void 0:e.moduleFeature,description:null==e?void 0:e.description,channels:t,http_method:null==e?void 0:e.httpMethod})}))}));var i={module:t,features:a,featureX:l};n.push(i)})),k(n)};return a.useEffect((function(){function e(){return(e=(0,o.Z)(m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("create"==i){e.next=4;break}return d(!0),e.next=4,(0,H.HZ)(i).then((function(e){D(e)})).catch((function(e){n(e.resultMessage,{variant:"error"}),l.push("/home/settings/access-management/list")}));case 4:return e.next=6,(0,H.hU)().then((function(e){x(null==e?void 0:e.moduleList);var t=null==e?void 0:e.moduleList;(0,H.z2)(null==e?void 0:e.moduleList).then((function(e){_(null==e?void 0:e.endpointAndChannelResponseList,t||[])}))})).catch((function(e){n(e.resultMessage,{variant:"error"}),l.push("/home/settings/access-management/list")})).finally((function(){return g(!1)}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}g(!0),function(){e.apply(this,arguments)}()}),[i]),a.createElement(a.Fragment,null,t({loading:f,data:E,module:b,features:M,updateData:C,isUpdate:u}))},z=function(){var e=(0,r.useTranslation)().t;return a.createElement(i.SeamlessContainer,{title:e("accessManagement","Access Management"),description:e("accessManagementDescription","")},a.createElement(l.Z,null,a.createElement(q,null,(function(e){var t=e.data,n=e.loading,l=e.module,i=e.features,r=e.updateData,o=e.isUpdate;return a.createElement(U,{data:t,loading:n,module:l,features:i,updateData:r,isUpdate:o})}))))}}}]);