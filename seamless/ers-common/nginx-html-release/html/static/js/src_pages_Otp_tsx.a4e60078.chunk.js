(self.webpackChunk_unified_portal=self.webpackChunk_unified_portal||[]).push([["src_pages_Otp_tsx"],{97378:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>S});var r,o=n(74315),a=n(51119),s=n(22459),i=n(182),c=n(49472),u=n(67358),l=n(90436),d=n(5700),p=n(79692),f=n(12420),g=n(62310),m=n(96545),h=n(36082),b=n(52074),y=n(6277),v=n(75514);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=(0,p.Z)((function(e){var t;return(0,f.Z)({root:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",flexWrap:"wrap"},fullWidth:{width:"100%"},otpFieldWrapper:{width:"14.5%",margin:"1%","&:first-child":{marginLeft:0},"&:last-child":{marginRight:0}},otpField:{"& .MuiInputBase-input":{fontSize:50,textAlign:"center",color:e.palette.text.secondary,padding:"".concat(e.spacing(2.5),"px ").concat(e.spacing(2),"px")}},button:{flexBasis:"100%"},actionButton:{background:e.palette.background.default,paddingLeft:e.spacing(2),paddingRight:e.spacing(2),"& .MuiButton-label":{justifyContent:"space-between"}},buttonMargin:{marginBottom:e.spacing(2)},helperText:(t={textAlign:"center",display:"block",marginTop:e.spacing(2),marginBottom:e.spacing(4)},(0,a.Z)(t,e.breakpoints.down("md"),{marginBottom:e.spacing(2)}),(0,a.Z)(t,"textDecoration","none"),(0,a.Z)(t,"color",e.palette.text.hint),(0,a.Z)(t,"&:hover",{textDecoration:"none"}),t)})})),P=(null===(r=window.config)||void 0===r?void 0:r.resendOTPTimeInSeconds)||150,x=null;const S=function(){var e=(0,c.useTranslation)().t,t=E(),n=(0,g.default)(),r=n.showErrorMessage,a=n.showInfoMessage,p=n.showSuccessMessage,f=(0,d.useHistory)(),O=s.useState(""),S=(0,o.Z)(O,2),C=S[0],M=S[1],Z=s.useState(!1),j=(0,o.Z)(Z,2),k=j[0],I=j[1],T=s.useState(P),B=(0,o.Z)(T,2),D=B[0],W=B[1];s.useEffect((function(){var e=h.WL.getItem("forgotPasswordData");if(!e)return f.push("/login/recovery/account");var t=JSON.parse(e);return t.userId||t.msisdn?t.notificationMode?(x=t,void setTimeout((function(){return W(0)}),1e3*D+500)):f.push("/login/recovery/forgot/password"):f.push("/login/recovery/account")}),[]);var _=s.useCallback((function(){if(!x||!x.userId&&!x.msisdn||!C)return f.push("/login/recovery/account"),r(e("anErrorOccurred","Something went wrong, An error occurred"));if(!C||6!==C.length)return r(e("invalidOTP","OTP is invalid, It should be 6 numbers"));var t=w(w({},x),{},{otp:C});(0,m.gl)(t).then((function(t){var n=t.resultMessage||e("anErrorOccurred");200!==t.resultCode&&0!==t.resultCode||function(t,n){var o={userId:t,notificationMode:n};(0,m.gF)(o).then((function(t){var r=t.resultDescription||t.resultMessage||e("anErrorOccurred");200!==t.resultCode&&0!==t.resultCode||(r=e("passwordResetSuccessful","Password reset successfully, A system generated password has been sent to you in "+n),f.push("/login")),a("".concat(r))})).catch((function(t){return r(t.resultMessage||t.message||e("anErrorOccurred"))})).finally((function(){return I(!1)}))}(x.userId||x.msisdn,x.notificationMode);a("".concat(n))})).catch((function(e){return r(e)})).finally((function(){return I(!1)}))}),[C,x]),N=s.useCallback((function(e){W(0)}),[]);return s.createElement(s.Fragment,null,s.createElement(b.Z,{classes:t,otpHandler:function(e){M(e)}}),s.createElement("div",{className:t.root},k&&s.createElement(u.Z,null),s.createElement(i.SeamlessButton,{type:"submit",variant:"contained",color:"primary",className:t.button,onClick:_,disabled:k,fullWidth:!0},e("otpVerify"))),s.createElement(l.Z,{className:t.helperText,variant:"body2"},"".concat(e("otpTimerCaption")," "),s.createElement(v.Z,{timeInSeconds:D,handleResetAction:N})," ".concat(e("minutes"))),s.createElement(i.SeamlessButton,{variant:"outlined",id:"resetButton",color:"primary",className:(0,y.default)(t.button,t.buttonMargin),onClick:function(){var t=h.WL.getItem("forgotPasswordData"),n=JSON.parse(t);I(!0),(0,m.P)(n).then((function(t){var n=t.resultMessage||e("anErrorOccurred");0==t.resultCode?(p(n),W(P)):r("".concat(n))})).catch((function(e){return r(e)})).finally((function(){return I(!1)}))},disabled:k||D>0,fullWidth:!0},e("resendOTP")))}}}]);